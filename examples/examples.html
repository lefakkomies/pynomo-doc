<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Examples &#8212; pyNomo Documentation 0.3.2.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Literature" href="../literature/literature.html" />
    <link rel="prev" title="Top level parameters" href="../main_params.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          pyNomo Documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_page.html">Big picture of nomograph construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../axes/axes.html">Axes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../types/types.html">Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alignment/alignment.html">Block alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transformations/transformations.html">Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_params.html">Top level parameters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../literature/literature.html">Literature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendices.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/bibliography.html">Bibliography</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Examples</a><ul>
<li><a class="reference internal" href="#gasoline-price-comparison">Gasoline Price comparison</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#generated-nomograph">Generated nomograph</a></li>
<li><a class="reference internal" href="#source-code">Source code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#voltage-divider">Voltage Divider</a><ul>
<li><a class="reference internal" href="#theory-and-background">Theory and background</a></li>
<li><a class="reference internal" href="#id3">Generated nomograph</a></li>
<li><a class="reference internal" href="#id4">Source code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bicycle-cadence">Bicycle Cadence</a><ul>
<li><a class="reference internal" href="#id5">Theory and background</a></li>
<li><a class="reference internal" href="#id9">Generated nomograph</a></li>
<li><a class="reference internal" href="#id10">Source code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#z-score">Z Score</a><ul>
<li><a class="reference internal" href="#id11">Theory and background</a></li>
<li><a class="reference internal" href="#id13">Generated nomograph</a></li>
<li><a class="reference internal" href="#id14">Source code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-amortized-loan-calculator">Example: Amortized loan calculator</a><ul>
<li><a class="reference internal" href="#id15">Theory and background</a><ul>
<li><a class="reference internal" href="#right-hand-side-of-equation">Right hand side of equation</a></li>
<li><a class="reference internal" href="#left-hand-side-of-equation">Left hand side of equation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id19">Generated nomograph</a></li>
<li><a class="reference internal" href="#id20">Source code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-photography-exposure">Example Photography exposure</a><ul>
<li><a class="reference internal" href="#id21">Theory and background</a><ul>
<li><a class="reference internal" href="#shadow-lenght">Shadow lenght</a></li>
</ul>
</li>
<li><a class="reference internal" href="#construction-of-the-nomograph">Construction of the nomograph</a></li>
<li><a class="reference internal" href="#id24">Generated nomograph</a></li>
<li><a class="reference internal" href="#id25">Source code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../main_params.html" title="Previous Chapter: Top level parameters"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Top level parameters</span>
    </a>
  </li>
  <li>
    <a href="../literature/literature.html" title="Next Chapter: Literature"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Literature &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/examples/examples.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>The following examples illustrate practical applications of nomographs.  Each example includes background and the underlying math for the nomograph construction. Source code shows the implementation.</p>
<section id="gasoline-price-comparison">
<h2>Gasoline Price comparison<a class="headerlink" href="#gasoline-price-comparison" title="Permalink to this headline">¶</a></h2>
<section id="background">
<h3>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<p>Comparing the unit price of a commodity with different units of measure
and currencies is greatly simplified with a nomograph.  In this example.
cross border travellers between the United States and Canada can easily
compare the cost of gasoline on both sides of the border.  Moreover, by
drawing an isopleth thorough the currency rate at par (1.0000) they can
directly convert dollars per litre to dollars per USG.  This nomograph
implements the following formula:</p>
<p><span class="math notranslate nohighlight">\(\frac{CAD}{L} =  \frac{CAD}{USD} \times \frac{USD}{US Gal} \div \frac{L}{US Gal}\)</span></p>
<p>This equation follows the form of a <strong>Type 2</strong> nomograph where:</p>
<p><span class="math notranslate nohighlight">\(F_1(u_1) = \frac{CAD}{L}\)</span>,</p>
<p><span class="math notranslate nohighlight">\(F_2(u_2) = \frac{CAD}{USD}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(F_3(u_3) = \frac{USD}{US Gal} \div 3.78541 \frac{L}{US Gal}\)</span></p>
</section>
<section id="generated-nomograph">
<h3>Generated nomograph<a class="headerlink" href="#generated-nomograph" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/ex_gasoline_pricing.png" src="../_images/ex_gasoline_pricing.png" />
</section>
<section id="source-code">
<h3>Source code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 2</span><span class="sd">    ex_gasoline_pricing.py</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="sd">    Gasoline price converter</span>
<span class="linenos"> 5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 8</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 9</span><span class="kn">from</span> <span class="nn">pyx</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># allows use of latex commands in PyX such as \frac{a}{b} and \par</span>
<span class="linenos">14</span><span class="n">pyx</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">LatexEngine</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="n">N_params_1</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">17</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span>
<span class="linenos">18</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">20</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{CAD}{L}</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="linenos">21</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos">22</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">23</span>    <span class="s2">&quot;text_format&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\$</span><span class="si">%3.3f</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="linenos">24</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">25</span>    <span class="s2">&quot;tick_side&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="linenos">26</span><span class="p">}</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="n">N_params_2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">29</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">30</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
<span class="linenos">31</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{CAD}{USD}</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="linenos">33</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos">34</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">35</span>    <span class="s2">&quot;text_format&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$</span><span class="si">%3.4f</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="linenos">36</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">37</span>    <span class="s2">&quot;title_x_shift&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">38</span>    <span class="s2">&quot;title_rotate_text&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">39</span><span class="p">}</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="n">N_params_3</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">42</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="linenos">43</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="linenos">44</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span> <span class="o">/</span> <span class="mf">3.78541</span><span class="p">,</span>
<span class="linenos">45</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{USD}</span><span class="s2">{US Gal}$&quot;</span><span class="p">,</span>
<span class="linenos">46</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos">47</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">48</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">49</span>    <span class="s2">&quot;text_format&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\$</span><span class="si">%3.3f</span><span class="s2">$&quot;</span><span class="p">,</span>
<span class="linenos">50</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">51</span><span class="p">}</span>
<span class="linenos">52</span>
<span class="linenos">53</span>
<span class="linenos">54</span><span class="n">block_1_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">55</span>    <span class="s2">&quot;block_type&quot;</span><span class="p">:</span> <span class="s2">&quot;type_2&quot;</span><span class="p">,</span>
<span class="linenos">56</span>    <span class="s2">&quot;f1_params&quot;</span><span class="p">:</span> <span class="n">N_params_1</span><span class="p">,</span>
<span class="linenos">57</span>    <span class="s2">&quot;f2_params&quot;</span><span class="p">:</span> <span class="n">N_params_2</span><span class="p">,</span>
<span class="linenos">58</span>    <span class="s2">&quot;f3_params&quot;</span><span class="p">:</span> <span class="n">N_params_3</span><span class="p">,</span>
<span class="linenos">59</span>    <span class="s2">&quot;isopleth_values&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]],</span>
<span class="linenos">60</span><span class="p">}</span>
<span class="linenos">61</span>
<span class="linenos">62</span><span class="n">main_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">63</span>    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;ex_gasoline_pricing.pdf&quot;</span><span class="p">,</span>
<span class="linenos">64</span>    <span class="s2">&quot;paper_height&quot;</span><span class="p">:</span> <span class="mf">11.0</span> <span class="o">*</span> <span class="mf">2.54</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">65</span>    <span class="s2">&quot;paper_width&quot;</span><span class="p">:</span> <span class="mf">8.5</span> <span class="o">*</span> <span class="mf">2.54</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">66</span>    <span class="s2">&quot;block_params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">block_1_params</span><span class="p">],</span>
<span class="linenos">67</span>    <span class="s2">&quot;transformations&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;rotate&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;scale paper&quot;</span><span class="p">,)],</span>
<span class="linenos">68</span>    <span class="s2">&quot;title_str&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\huge \textbf{Gas Price Converter}&quot;</span><span class="p">,</span>
<span class="linenos">69</span>    <span class="s2">&quot;title_y&quot;</span><span class="p">:</span> <span class="mf">13.50</span><span class="p">,</span>
<span class="linenos">70</span>    <span class="s2">&quot;title_box_width&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
<span class="linenos">71</span>    <span class="s2">&quot;extra_texts&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">72</span>        <span class="p">{</span>
<span class="linenos">73</span>            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">74</span>            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">12.5</span><span class="p">,</span>
<span class="linenos">75</span>            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\noindent Is gasoline cheaper </span><span class="se">\</span>
<span class="linenos">76</span><span class="s2">                south of the 49\textsuperscript</span><span class="si">{th}</span><span class="s2">? Use this gas price </span><span class="se">\</span>
<span class="linenos">77</span><span class="s2">                converter to be sure. In the example </span><span class="se">\</span>
<span class="linenos">78</span><span class="s2">                shown, \$1.300 $\frac</span><span class="si">{CAD}{L}</span><span class="s2">$ is the same price as \$3.52 $\frac</span><span class="si">{USD}</span><span class="s2">{US Gal}$ if the exchange rate is 1.40  $\frac</span><span class="si">{CAD}{USD}</span><span class="s2">$.&quot;</span><span class="p">,</span>
<span class="linenos">79</span>            <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
<span class="linenos">80</span>        <span class="p">},</span>
<span class="linenos">81</span>        <span class="p">{</span>
<span class="linenos">82</span>            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\copyright Daniel Boulet (2019-2021)&quot;</span><span class="p">,</span>
<span class="linenos">83</span>            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="linenos">84</span>            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span>
<span class="linenos">85</span>        <span class="p">},</span>
<span class="linenos">86</span>    <span class="p">],</span>
<span class="linenos">87</span>    <span class="c1"># &#39;make_grid&#39;: True</span>
<span class="linenos">88</span><span class="p">}</span>
<span class="linenos">89</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="voltage-divider">
<h2>Voltage Divider<a class="headerlink" href="#voltage-divider" title="Permalink to this headline">¶</a></h2>
<section id="theory-and-background">
<h3>Theory and background<a class="headerlink" href="#theory-and-background" title="Permalink to this headline">¶</a></h3>
<p>In electronics, resistive voltage dividers are used for a variety of purposes.
The formula for a resistive voltage divider is <span id="id1">[<a class="reference internal" href="../appendix/bibliography.html#id14" title="Wikipedia. Voltage divider — Wikipedia, the free encyclopedia. \url http://en.wikipedia.org/w/index.php?title=Voltage%20divider&amp;oldid=1047836365, 2021. [Online; accessed 31-December-2021].">Wik21b</a>]</span>:</p>
<p><span class="math notranslate nohighlight">\(\frac{V_{out}}{V_{in}} = \frac{R_b}{(R_a + R_b)}\)</span></p>
<a class="reference internal image-reference" href="../_images/ex_voltage_divider_schematic.png"><img alt="../_images/ex_voltage_divider_schematic.png" src="../_images/ex_voltage_divider_schematic.png" style="width: 200px;" /></a>
<p>When designing voltage dividers, constraints may demand engineers choose
resistors from a set of “preferred values” <span id="id2">[<a class="reference internal" href="../appendix/bibliography.html#id15" title="Wikipedia. E series of preferred numbers — Wikipedia, the free encyclopedia. \url http://en.wikipedia.org/w/index.php?title=E%20series%20of%20preferred%20numbers&amp;oldid=1059349411, 2021. [Online; accessed 31-December-2021].">Wik21a</a>]</span>. These values are
discrete and engineers must select the best combination of resistors
based on tolerance and the available preferred values.  Similar voltage
ratios can be obtained with different combinations of resistor values.</p>
<p>The voltage divider nomograph links input voltage (<span class="math notranslate nohighlight">\(V_{in}\)</span>), output voltage (<span class="math notranslate nohighlight">\(V_{out}\)</span>) and a
pair of resistor values into a single nomograph.  Pynomo’s <strong>Type 5</strong> blocks
are well suited for plotting relationships between pairs of discrete values.
A vertical line dropped from the intersection of <span class="math notranslate nohighlight">\(R_a\)</span> values and <span class="math notranslate nohighlight">\(R_b\)</span> values
reveals the <span class="math notranslate nohighlight">\(V_{out}\)</span> / <span class="math notranslate nohighlight">\(V_{in}\)</span> voltage ratio.  Alignment with a <strong>Type 2</strong> block allows
the engineer to determine <span class="math notranslate nohighlight">\(V_{out}\)</span> given <span class="math notranslate nohighlight">\(V_{in}\)</span> (or vice versa).</p>
<p>Of greater benefit is the ability to quickly determine the optimum pair
of resistor values for a given application.  For example, given an input
voltage (9V) and desired output voltage (3.3V), the engineer draws a straight
line from the <span class="math notranslate nohighlight">\(V_{out}\)</span> axis, through the <span class="math notranslate nohighlight">\(V_{in}\)</span> axis to the base of the voltage ratio
graph.  A perpendicular line is then drawn from the base to the top of the
graph.  The vertical line’s nearest approach to the intersection of <span class="math notranslate nohighlight">\(R_a\)</span> and
<span class="math notranslate nohighlight">\(R_b\)</span> values represents the best combination of resistor values.  It can be
quickly shown that one combination of values (<span class="math notranslate nohighlight">\(R_a\)</span> = 6.2 and <span class="math notranslate nohighlight">\(R_b\)</span> = 3.6) will
produce an output voltage very close to the desired value (3.3061V).</p>
</section>
<section id="id3">
<h3>Generated nomograph<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/ex_voltage_divider.png" src="../_images/ex_voltage_divider.png" />
</section>
<section id="id4">
<h3>Source code<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  2</span><span class="sd">    voltdiv_E24_resistors.py</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="sd">    Nomogram to calculate resistor values for simple voltage divider.  This</span>
<span class="linenos">  5</span><span class="sd">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="linenos">  6</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">  9</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 10</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="kn">from</span> <span class="nn">pyx</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 13</span><span class="n">pyx</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">LatexEngine</span><span class="p">)</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="n">resistors</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 18</span>	<span class="mf">1.0</span><span class="p">,</span>	<span class="mf">1.1</span><span class="p">,</span>	<span class="mf">1.2</span><span class="p">,</span>
<span class="linenos"> 19</span>	<span class="mf">1.3</span><span class="p">,</span>	<span class="mf">1.5</span><span class="p">,</span>	<span class="mf">1.6</span><span class="p">,</span>
<span class="linenos"> 20</span>	<span class="mf">1.8</span><span class="p">,</span>	<span class="mf">2.0</span><span class="p">,</span>	<span class="mf">2.2</span><span class="p">,</span>
<span class="linenos"> 21</span>	<span class="mf">2.4</span><span class="p">,</span>	<span class="mf">2.7</span><span class="p">,</span>	<span class="mf">3.0</span><span class="p">,</span>
<span class="linenos"> 22</span>	<span class="mf">3.3</span><span class="p">,</span>	<span class="mf">3.6</span><span class="p">,</span>	<span class="mf">3.9</span><span class="p">,</span>
<span class="linenos"> 23</span>	<span class="mf">4.3</span><span class="p">,</span>	<span class="mf">4.7</span><span class="p">,</span>	<span class="mf">5.1</span><span class="p">,</span>
<span class="linenos"> 24</span>	<span class="mf">5.6</span><span class="p">,</span>	<span class="mf">6.2</span><span class="p">,</span>	<span class="mf">6.8</span><span class="p">,</span>
<span class="linenos"> 25</span>	<span class="mf">7.5</span><span class="p">,</span>	<span class="mf">8.2</span><span class="p">,</span>	<span class="mf">9.1</span>
<span class="linenos"> 26</span><span class="p">]</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="c1"># Type 5 contour</span>
<span class="linenos"> 29</span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="linenos"> 30</span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="n">block_1_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 34</span>    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span>
<span class="linenos"> 35</span>    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
<span class="linenos"> 36</span>    <span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_5&#39;</span><span class="p">,</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span>    <span class="s1">&#39;u_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 39</span>    <span class="s1">&#39;u_values&#39;</span><span class="p">:</span> <span class="n">resistors</span><span class="p">,</span>
<span class="linenos"> 40</span>    <span class="s1">&#39;u_axis_color&#39;</span><span class="p">:</span> <span class="n">pyx</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">cmyk</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span>
<span class="linenos"> 41</span>    <span class="s1">&#39;u_title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\Large{$R_a$}&#39;</span><span class="p">,</span>
<span class="linenos"> 42</span>    <span class="s1">&#39;u_text_format&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\normalsize{$</span><span class="si">%3.1f</span><span class="s2">$}&quot;</span><span class="p">,</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>    <span class="s1">&#39;v_func&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
<span class="linenos"> 45</span>    <span class="s1">&#39;v_values&#39;</span><span class="p">:</span> <span class="n">resistors</span><span class="p">,</span>
<span class="linenos"> 46</span>    <span class="s1">&#39;v_axis_color&#39;</span><span class="p">:</span> <span class="n">pyx</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">cmyk</span><span class="o">.</span><span class="n">Red</span><span class="p">,</span>
<span class="linenos"> 47</span>    <span class="s1">&#39;v_title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\Large{$R_b$}&#39;</span><span class="p">,</span>
<span class="linenos"> 48</span>    <span class="s1">&#39;v_text_format&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\normalsize{$</span><span class="si">%3.1f</span><span class="s2">$}&quot;</span><span class="p">,</span>
<span class="linenos"> 49</span>
<span class="linenos"> 50</span>    <span class="s1">&#39;wd_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
<span class="linenos"> 51</span>    <span class="s1">&#39;wd_tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos"> 52</span>	<span class="s1">&#39;wd_title&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;\Large $\frac{V_</span><span class="si">{out}</span><span class="s1">}{V_</span><span class="si">{in}</span><span class="s1">}$&#39;</span><span class="p">,</span>
<span class="linenos"> 53</span>    <span class="s1">&#39;wd_tick_levels&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos"> 54</span>    <span class="s1">&#39;wd_tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 55</span>    <span class="s1">&#39;wd_title_opposite_tick&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 56</span>    <span class="s1">&#39;wd_axis_color&#39;</span><span class="p">:</span> <span class="n">pyx</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">cmyk</span><span class="o">.</span><span class="n">Gray</span><span class="p">,</span>
<span class="linenos"> 57</span>    <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos"> 58</span>        <span class="p">[</span><span class="mf">6.2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="linenos"> 59</span>    <span class="p">],</span>
<span class="linenos"> 60</span>    <span class="s1">&#39;vertical_guide_nr&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="linenos"> 61</span>	<span class="s1">&#39;manual_x_scale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>		<span class="c1"># trick to &quot;decompress&quot; Ra scale</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="p">}</span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span><span class="c1"># this is non-obvious trick to find bottom edge coordinates of the grid in order</span>
<span class="linenos"> 66</span><span class="c1"># to align it with N nomogram</span>
<span class="linenos"> 67</span><span class="n">block1_dummy</span> <span class="o">=</span> <span class="n">Nomo_Block_Type_5</span><span class="p">(</span><span class="n">mirror_x</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos"> 68</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">define_block</span><span class="p">(</span><span class="n">block_1_params</span><span class="p">)</span>
<span class="linenos"> 69</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">set_block</span><span class="p">()</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span><span class="c1"># Let&#39;s define the N-nomogram</span>
<span class="linenos"> 72</span><span class="n">N_params_3</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 73</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="n">block1_dummy</span><span class="o">.</span><span class="n">grid_box</span><span class="o">.</span><span class="n">params_wd</span><span class="p">[</span><span class="s1">&#39;u_min&#39;</span><span class="p">],</span>
<span class="linenos"> 74</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="n">block1_dummy</span><span class="o">.</span><span class="n">grid_box</span><span class="o">.</span><span class="n">params_wd</span><span class="p">[</span><span class="s1">&#39;u_max&#39;</span><span class="p">],</span>
<span class="linenos"> 75</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 76</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos"> 77</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
<span class="linenos"> 78</span>    <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos"> 79</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 80</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 81</span>    <span class="s1">&#39;reference&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 82</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos"> 83</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos"> 84</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="linenos"> 85</span><span class="p">}</span>
<span class="linenos"> 86</span><span class="n">N_params_2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 87</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
<span class="linenos"> 88</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">24.0</span><span class="p">,</span>
<span class="linenos"> 89</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 90</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$V_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="linenos"> 91</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="linenos"> 92</span>    <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos"> 93</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 94</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 95</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 96</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos"> 97</span><span class="p">}</span>
<span class="linenos"> 98</span><span class="n">N_params_1</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 99</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">100</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">101</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">102</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$V_</span><span class="si">{out}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="linenos">103</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="linenos">104</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos">105</span>    <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">106</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">107</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">108</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="linenos">109</span><span class="p">}</span>
<span class="linenos">110</span>
<span class="linenos">111</span><span class="n">block_2_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">112</span>    <span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_2&#39;</span><span class="p">,</span>
<span class="linenos">113</span>    <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span> <span class="n">N_params_1</span><span class="p">,</span>
<span class="linenos">114</span>    <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span> <span class="n">N_params_2</span><span class="p">,</span>
<span class="linenos">115</span>    <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span> <span class="n">N_params_3</span><span class="p">,</span>
<span class="linenos">116</span>    <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">117</span>        <span class="c1"># Vout, Vin, ratio</span>
<span class="linenos">118</span>        <span class="p">[</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="linenos">119</span>    <span class="p">]</span>
<span class="linenos">120</span><span class="p">}</span>
<span class="linenos">121</span>
<span class="linenos">122</span><span class="n">main_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">123</span>    <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="s1">&#39;ex_voltage_divider.pdf&#39;</span><span class="p">,</span>
<span class="linenos">124</span>    <span class="s1">&#39;paper_height&#39;</span><span class="p">:</span> <span class="mf">8.5</span><span class="o">*</span><span class="mf">2.54</span><span class="p">,</span>
<span class="linenos">125</span>    <span class="s1">&#39;paper_width&#39;</span><span class="p">:</span> <span class="mf">11.0</span><span class="o">*</span><span class="mf">2.54</span><span class="p">,</span>
<span class="linenos">126</span>    <span class="s1">&#39;block_params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">block_1_params</span><span class="p">,</span> <span class="n">block_2_params</span><span class="p">],</span>
<span class="linenos">127</span>    <span class="s1">&#39;transformations&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;scale paper&#39;</span><span class="p">,)],</span>
<span class="linenos">128</span>    <span class="s1">&#39;title_str&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\Large Voltage Divider Nomograph \par </span><span class="se">\</span>
<span class="linenos">129</span><span class="s1">        \normalsize (For E24 series values) \par \bigskip </span><span class="se">\</span>
<span class="linenos">130</span><span class="s1">        \large $V_</span><span class="si">{out}</span><span class="s1">=V_</span><span class="si">{in}</span><span class="s1"> \cdot \frac</span><span class="si">{R_b}</span><span class="s1">{R_a+R_b}$ </span><span class="se">\</span>
<span class="linenos">131</span><span class="s1">        \par \bigskip   \normalsize \copyright    Daniel Boulet  2018-2021&#39;</span><span class="p">,</span>
<span class="linenos">132</span>    <span class="s1">&#39;title_x&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">133</span>    <span class="s1">&#39;title_y&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="linenos">134</span>    <span class="s1">&#39;isopleth_params&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">135</span>        <span class="p">{</span>
<span class="linenos">136</span>            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="linenos">137</span>            <span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="s1">&#39;thick&#39;</span><span class="p">,</span>
<span class="linenos">138</span>            <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;dashed&#39;</span><span class="p">,</span>
<span class="linenos">139</span>            <span class="s1">&#39;circle_size&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span>
<span class="linenos">140</span>        <span class="p">},</span>
<span class="linenos">141</span>    <span class="p">],</span>
<span class="linenos">142</span><span class="p">}</span>
<span class="linenos">143</span>
<span class="linenos">144</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="bicycle-cadence">
<h2>Bicycle Cadence<a class="headerlink" href="#bicycle-cadence" title="Permalink to this headline">¶</a></h2>
<section id="id5">
<h3>Theory and background<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/gear_image_1.pdf"><img alt="../_images/gear_image_1.pdf" src="../_images/gear_image_1.pdf" /></a>
</figure>
<p>Choosing the correct gears on a bicycle allows a cyclist to maintain a comfortable cadence.  A higher
cadence helps reduce muscle fatigue <span id="id6">[<a class="reference internal" href="../appendix/bibliography.html#id16" title="What to consider when finding your ideal cycling cadence. Dec 2021. URL: https://www.trainingpeaks.com/blog/what-to-consider-when-finding-your-ideal-cycling-cadence/.">tra21</a>]</span> though it does put more stress on heart and
lungs.  However a lower cadence for the same power output puts more stress on the rider’s knees,
hips and back. <span id="id7">[<a class="reference internal" href="../appendix/bibliography.html#id17" title="Cycling cadence - what is it and why you should keep a close eye on yours? Mar 2021. URL: https://thebodymechanic.com.au/cycling-cadence-what-is-it-and-why-you-should-keep-a-close-eye-on-yours/.">the21</a>]</span> Furthermore, cycling cadence will vary widely with beginning cyclists peddling more
slowly (60-85 rpm) and professionals exceeding 100 rpm under certain conditions.
Generally, a good cadence in cycling is between 80-100 rpm. <span id="id8">[<a class="reference internal" href="../appendix/bibliography.html#id19" title="Sean Hurley. Cycling Cadence: What Is It, What's Most Efficient, and Cadence Drills To Make You Faster - TrainerRoad Blog. October 2021. URL: https://www.trainerroad.com/blog/whats-the-most-efficient-cycling-cadence-and-how-cadence-drills-can-make-you-faster/ (visited on 2021-12-31).">Hur21</a>]</span> The
correct gear ratio can help the rider maximize their speed with a comfortable cadence.</p>
<p>A bicycle’s speed is the product of the wheel diameter (e.g. 700mm),
the wheel’s rotation rate (in rpm) and <span class="math notranslate nohighlight">\(\pi\)</span>. The wheel’s rotation rate is a function of
the rider’s cadence and the front to rear gear ratio. As in the previous example, pairs
of discrete values such as the number of teeth on the front and rear sprockets are
easily represented on a <strong>Type 5</strong> block.  This nomograph combines a <strong>Type 5</strong> block (to
calculate gearing ratio) with a pair of <strong>Type 2</strong> blocks to calculate the rider’s
speed given their cadence and gear settings.</p>
</section>
<section id="id9">
<h3>Generated nomograph<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/ex_bicycle_cadence.png" src="../_images/ex_bicycle_cadence.png" />
</section>
<section id="id10">
<h3>Source code<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  2</span><span class="sd">    ex_bicycle_cadence.py</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="sd">    Bicycle gearing cadence and speed calculator</span>
<span class="linenos">  5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  6</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">  7</span><span class="kn">from</span> <span class="nn">pyx</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">  8</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos">  9</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos"> 10</span><span class="n">pyx</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">LatexEngine</span><span class="p">)</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span><span class="n">gearing</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 14</span>    <span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_5&#39;</span><span class="p">,</span>
<span class="linenos"> 15</span>    <span class="s1">&#39;wd_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span>    <span class="s1">&#39;u_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 18</span>    <span class="s1">&#39;v_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span><span class="o">/</span><span class="n">x</span><span class="p">,</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span>	<span class="c1"># teeth on rear cage</span>
<span class="linenos"> 21</span>    <span class="s1">&#39;u_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">],</span>
<span class="linenos"> 22</span>    <span class="s1">&#39;u_scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual point&#39;</span><span class="p">,</span>
<span class="linenos"> 23</span>    <span class="s1">&#39;u_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">12.0</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">:</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="mf">21.0</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="mf">28.0</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
<span class="linenos"> 24</span>    <span class="s1">&#39;u_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Rear cage&#39;</span><span class="p">,</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span>	<span class="c1"># teeth on front derailer</span>
<span class="linenos"> 27</span>    <span class="s1">&#39;v_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">28.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">],</span>
<span class="linenos"> 28</span>    <span class="s1">&#39;v_scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual point&#39;</span><span class="p">,</span>
<span class="linenos"> 29</span>    <span class="s1">&#39;v_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">28.0</span><span class="p">:</span> <span class="s1">&#39;Small&#39;</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">:</span> <span class="s1">&#39;Large&#39;</span><span class="p">},</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span>    <span class="s1">&#39;wd_tick_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 32</span>    <span class="s1">&#39;wd_tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 33</span>    <span class="s1">&#39;wd_tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos"> 34</span>    <span class="s1">&#39;wd_title_opposite_tick&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 35</span>    <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">38.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="p">}</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span><span class="n">wheelrpm</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 41</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;wheelrpm&#39;</span><span class="p">,</span>
<span class="linenos"> 42</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
<span class="linenos"> 43</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">360.0</span><span class="p">,</span>
<span class="linenos"> 44</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual point&#39;</span><span class="p">,</span>
<span class="linenos"> 45</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 46</span><span class="p">}</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="n">crankrpm</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 49</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">60.0</span><span class="p">,</span>
<span class="linenos"> 50</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span>
<span class="linenos"> 51</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 52</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\large \slshape Cadence (RPM)&#39;</span><span class="p">,</span>
<span class="linenos"> 53</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 54</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 55</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos"> 56</span>	<span class="s1">&#39;tick_side&#39;</span><span class="p">:</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos"> 57</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 58</span>    <span class="c1"># &#39;title_distance_center&#39;: -0.5,</span>
<span class="linenos"> 59</span><span class="p">}</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="n">ratio</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 62</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual point&#39;</span><span class="p">,</span>
<span class="linenos"> 63</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
<span class="linenos"> 64</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos"> 65</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="linenos"> 66</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 67</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 68</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 69</span><span class="p">}</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span>
<span class="linenos"> 72</span><span class="n">rotation</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 73</span>    <span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_2&#39;</span><span class="p">,</span>
<span class="linenos"> 74</span>    <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span> <span class="n">wheelrpm</span><span class="p">,</span>
<span class="linenos"> 75</span>    <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span> <span class="n">crankrpm</span><span class="p">,</span>
<span class="linenos"> 76</span>    <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span> <span class="n">ratio</span><span class="p">,</span>
<span class="linenos"> 77</span>    <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos"> 78</span><span class="p">}</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span><span class="n">speed</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 82</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
<span class="linenos"> 83</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span>
<span class="linenos"> 84</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos"> 85</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\large \slshape Speed (km/hour)&#39;</span><span class="p">,</span>
<span class="linenos"> 86</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos"> 87</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 88</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos"> 89</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos"> 90</span>    <span class="s1">&#39;title_distance_center&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos"> 91</span><span class="p">}</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span><span class="n">diameter</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 94</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">600.0</span><span class="p">,</span>
<span class="linenos"> 95</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">800.0</span><span class="p">,</span>
<span class="linenos"> 96</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="o">*</span><span class="mf">3.1415927</span><span class="o">*</span><span class="mf">60.0</span><span class="o">/</span><span class="mf">1000000.0</span><span class="p">,</span>
<span class="linenos"> 97</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Wheel Diameter (mm)&#39;</span><span class="p">,</span>
<span class="linenos"> 98</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 99</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos">100</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos">101</span>    <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">102</span>    <span class="s1">&#39;title_distance_center&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">103</span>
<span class="linenos">104</span><span class="p">}</span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="n">wheelrpm2</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">107</span>    <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;wheelrpm&#39;</span><span class="p">,</span>
<span class="linenos">108</span>    <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
<span class="linenos">109</span>    <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">360.0</span><span class="p">,</span>
<span class="linenos">110</span>    <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">111</span>    <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos">112</span>
<span class="linenos">113</span>    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\large \slshape Wheel RPM&#39;</span><span class="p">,</span>
<span class="linenos">114</span>    <span class="s1">&#39;title_x_shift&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">18.5</span><span class="p">,</span>
<span class="linenos">115</span>    <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos">116</span>    <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">117</span><span class="p">}</span>
<span class="linenos">118</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="n">speedblock</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">121</span>    <span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_2&#39;</span><span class="p">,</span>
<span class="linenos">122</span>    <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span> <span class="n">speed</span><span class="p">,</span>
<span class="linenos">123</span>    <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span> <span class="n">diameter</span><span class="p">,</span>
<span class="linenos">124</span>    <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span> <span class="n">wheelrpm2</span><span class="p">,</span>
<span class="linenos">125</span>    <span class="s1">&#39;mirror_x&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">126</span>    <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">750.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos">127</span><span class="p">}</span>
<span class="linenos">128</span>
<span class="linenos">129</span>
<span class="linenos">130</span><span class="n">main_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">131</span>    <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="s1">&#39;ex_bicycle_cadence.pdf&#39;</span><span class="p">,</span>
<span class="linenos">132</span>    <span class="s1">&#39;block_params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">gearing</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">speedblock</span><span class="p">],</span>
<span class="linenos">133</span>    <span class="s1">&#39;transformations&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;scale paper&#39;</span><span class="p">,)],</span>
<span class="linenos">134</span>    <span class="s1">&#39;title_str&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\Large \textbf{Bicycle Cadence Calculator}&#39;</span><span class="p">,</span>
<span class="linenos">135</span>    <span class="s1">&#39;title_x&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
<span class="linenos">136</span>    <span class="s1">&#39;title_y&#39;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
<span class="linenos">137</span>
<span class="linenos">138</span>    <span class="s1">&#39;extra_texts&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">139</span>        <span class="p">{</span>
<span class="linenos">140</span>            <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">141</span>            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">11.3</span><span class="p">,</span>
<span class="linenos">142</span>            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\large \slshape{Gearing Ratio}&#39;</span><span class="p">,</span>
<span class="linenos">143</span>        <span class="p">},</span>
<span class="linenos">144</span>        <span class="p">{</span>
<span class="linenos">145</span>            <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
<span class="linenos">146</span>            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">20.5</span><span class="p">,</span>
<span class="linenos">147</span>            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\large \slshape{Front derailer setting}&#39;</span><span class="p">,</span>
<span class="linenos">148</span>        <span class="p">},</span>
<span class="linenos">149</span>        <span class="p">{</span>
<span class="linenos">150</span>            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\copyright Daniel Boulet (2019-2021)&#39;</span><span class="p">,</span>
<span class="linenos">151</span>            <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">152</span>            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="linenos">153</span>        <span class="p">},</span>
<span class="linenos">154</span>
<span class="linenos">155</span>
<span class="linenos">156</span>    <span class="p">],</span>
<span class="linenos">157</span>	<span class="c1"># &#39;make_grid&#39;:True,</span>
<span class="linenos">158</span>
<span class="linenos">159</span><span class="p">}</span>
<span class="linenos">160</span>
<span class="linenos">161</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="z-score">
<h2>Z Score<a class="headerlink" href="#z-score" title="Permalink to this headline">¶</a></h2>
<section id="id11">
<h3>Theory and background<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>This example extends Pynomo’s versatility by using external libraries.
Python’s <code class="code docutils literal notranslate"><span class="pre">scipy</span></code> library is the engine behind this nomograph
which calculates the area under a normal distribution curve between
two Z scores (one negative, the other positive).</p>
<p>To calculate the area between two Z scores (<span class="math notranslate nohighlight">\(Z_{upper}\)</span>,
<span class="math notranslate nohighlight">\(Z_{lower}\)</span>) of a normal distribution one must compute the
difference between the respective probability density functions
<span class="math notranslate nohighlight">\(\mathrm{PDF}(Z_{upper})\)</span> and <span class="math notranslate nohighlight">\(\mathrm{PDF}(Z_{lower})\)</span>. <span id="id12">[<a class="reference internal" href="../appendix/bibliography.html#id18" title="English: The re-drawn chart comparing the various grading methods in a normal distribution. Includes: Standard deviations, cumulative percentages, percentile equivalents, Z-scores and T-scores. Inspired by Figure 4.3 on Page 74 of Ward, A. W., Murray-Ward, M. (1999). Assessment in the Classroom. Belmont, CA: Wadsworth. ISBN 0534527043. July 2007. URL: https://commons.wikimedia.org/wiki/File:The_Normal_Distribution.svg (visited on 2021-12-31).">wik07</a>]</span></p>
<img alt="../_images/The_Normal_Distribution.svg" src="../_images/The_Normal_Distribution.svg" /><p>Recall that the functional relatinship for a <strong>Type 1</strong> block is:</p>
<p><span class="math notranslate nohighlight">\(F1(u_1)+F2(u_2)+F3(u_3)=0\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\mathrm{Area} = \mathrm{PDF}(Z_{upper}) - \mathrm{PDF}(Z_{lower})\)</span></p>
<p>therefore</p>
<p><span class="math notranslate nohighlight">\(\mathrm{PDF}(Z_{upper})  - Area  - \mathrm{PDF}(Z_{lower})=0\)</span>.</p>
<p>Two <strong>Type 8</strong> axes are aligned with <span class="math notranslate nohighlight">\(\mathrm{PDF}(Z_{upper})\)</span> and
<span class="math notranslate nohighlight">\(\mathrm{PDF}(Z_{lower})\)</span> to align a Z score with its associated PDF.</p>
</section>
<section id="id13">
<h3>Generated nomograph<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/ex_zscore.png" src="../_images/ex_zscore.png" />
</section>
<section id="id14">
<h3>Source code<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  2</span><span class="sd">    ex_zscore.py</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="sd">    Nomograph to calculate area under normal curve from z-score.</span>
<span class="linenos">  5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="linenos">  8</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">  9</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos"> 12</span><span class="c1"># allows use of latex commands in PyX such as \frac{a}{b} and \par</span>
<span class="linenos"> 13</span><span class="kn">from</span> <span class="nn">pyx</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="n">pyx</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">LatexEngine</span><span class="p">)</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<span class="linenos"> 19</span>    <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="k">def</span> <span class="nf">ppf</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<span class="linenos"> 23</span>    <span class="k">return</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="n">lmin</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="linenos"> 27</span><span class="n">lmax</span> <span class="o">=</span> <span class="mf">0.9999</span>
<span class="linenos"> 28</span>
<span class="linenos"> 29</span><span class="n">sd1</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="linenos"> 30</span><span class="n">sd2</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">)</span>
<span class="linenos"> 31</span><span class="n">sd3</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">)</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="n">leftpdf</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 35</span>    <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos"> 36</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="n">lmin</span><span class="p">,</span>
<span class="linenos"> 37</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos"> 38</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 39</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;manual point&quot;</span><span class="p">,</span>
<span class="linenos"> 40</span>    <span class="c1"># extra parameters</span>
<span class="linenos"> 41</span>    <span class="s2">&quot;extra_params&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos"> 42</span>        <span class="p">{</span>
<span class="linenos"> 43</span>            <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;manual arrow&quot;</span><span class="p">,</span>
<span class="linenos"> 44</span>            <span class="s2">&quot;manual_axis_data&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 45</span>                <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">),</span>
<span class="linenos"> 46</span>                <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">),</span>
<span class="linenos"> 47</span>                <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">),</span>
<span class="linenos"> 48</span>                <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">),</span>
<span class="linenos"> 49</span>            <span class="p">},</span>
<span class="linenos"> 50</span>            <span class="s2">&quot;arrow_length&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos"> 51</span>        <span class="p">},</span>
<span class="linenos"> 52</span>    <span class="p">],</span>
<span class="linenos"> 53</span><span class="p">}</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>
<span class="linenos"> 56</span><span class="n">leftz</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 57</span>    <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<span class="linenos"> 58</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="n">ppf</span><span class="p">(</span><span class="n">lmin</span><span class="p">),</span>
<span class="linenos"> 59</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
<span class="linenos"> 60</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 61</span>    <span class="s2">&quot;align_func&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 62</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Lower tail $X_1$&quot;</span><span class="p">,</span>
<span class="linenos"> 63</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos"> 64</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 65</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos"> 66</span>    <span class="s2">&quot;tick_side&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="linenos"> 67</span><span class="p">}</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="n">rightpdf</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 71</span>    <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="linenos"> 72</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos"> 73</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="n">lmax</span><span class="p">,</span>
<span class="linenos"> 74</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 75</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;manual point&quot;</span><span class="p">,</span>
<span class="linenos"> 76</span>    <span class="c1"># extra parameters</span>
<span class="linenos"> 77</span>    <span class="s2">&quot;extra_params&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos"> 78</span>        <span class="p">{</span>
<span class="linenos"> 79</span>            <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;manual arrow&quot;</span><span class="p">,</span>
<span class="linenos"> 80</span>            <span class="s2">&quot;tick_side&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="linenos"> 81</span>            <span class="s2">&quot;manual_axis_data&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos"> 82</span>                <span class="n">cdf</span><span class="p">(</span><span class="mf">3.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
<span class="linenos"> 83</span>                <span class="n">cdf</span><span class="p">(</span><span class="mf">2.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
<span class="linenos"> 84</span>                <span class="n">cdf</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span>
<span class="linenos"> 85</span>                <span class="n">cdf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">):</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
<span class="linenos"> 86</span>            <span class="p">},</span>
<span class="linenos"> 87</span>            <span class="s2">&quot;arrow_length&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos"> 88</span>        <span class="p">},</span>
<span class="linenos"> 89</span>    <span class="p">],</span>
<span class="linenos"> 90</span><span class="p">}</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span><span class="n">rightz</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos"> 94</span>    <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="linenos"> 95</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
<span class="linenos"> 96</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="n">ppf</span><span class="p">(</span><span class="n">lmax</span><span class="p">),</span>
<span class="linenos"> 97</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 98</span>    <span class="s2">&quot;align_func&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">cdf</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos"> 99</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Upper tail $X_2$&quot;</span><span class="p">,</span>
<span class="linenos">100</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos">101</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos">102</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">103</span><span class="p">}</span>
<span class="linenos">104</span>
<span class="linenos">105</span><span class="n">leftblock2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;block_type&quot;</span><span class="p">:</span> <span class="s2">&quot;type_8&quot;</span><span class="p">,</span> <span class="s2">&quot;f_params&quot;</span><span class="p">:</span> <span class="n">leftz</span><span class="p">,</span> <span class="s2">&quot;isopleth_values&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">]]}</span>
<span class="linenos">106</span>
<span class="linenos">107</span>
<span class="linenos">108</span><span class="n">rightblock2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;block_type&quot;</span><span class="p">:</span> <span class="s2">&quot;type_8&quot;</span><span class="p">,</span> <span class="s2">&quot;f_params&quot;</span><span class="p">:</span> <span class="n">rightz</span><span class="p">,</span> <span class="s2">&quot;isopleth_values&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">]]}</span>
<span class="linenos">109</span>
<span class="linenos">110</span>
<span class="linenos">111</span><span class="n">delta</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">112</span>    <span class="s2">&quot;u_min&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos">113</span>    <span class="s2">&quot;u_max&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">114</span>    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">115</span>    <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;linear smart&quot;</span><span class="p">,</span>
<span class="linenos">116</span>    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span>
<span class="linenos">117</span>    <span class="s2">&quot;tick_levels&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="linenos">118</span>    <span class="s2">&quot;tick_text_levels&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos">119</span>    <span class="s2">&quot;extra_params&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">120</span>        <span class="p">{</span>
<span class="linenos">121</span>            <span class="s2">&quot;tick_side&quot;</span><span class="p">:</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span>
<span class="linenos">122</span>            <span class="s2">&quot;scale_type&quot;</span><span class="p">:</span> <span class="s2">&quot;manual arrow&quot;</span><span class="p">,</span>
<span class="linenos">123</span>            <span class="s2">&quot;manual_axis_data&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos">124</span>                <span class="n">sd1</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\pm 1 \sigma$ </span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sd1</span><span class="p">,</span>
<span class="linenos">125</span>                <span class="n">sd2</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\pm 2 \sigma$ </span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sd2</span><span class="p">,</span>
<span class="linenos">126</span>                <span class="n">sd3</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\pm 3 \sigma$ </span><span class="si">%4.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sd3</span><span class="p">,</span>
<span class="linenos">127</span>            <span class="p">},</span>
<span class="linenos">128</span>            <span class="s2">&quot;arrow_length&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">129</span>        <span class="p">},</span>
<span class="linenos">130</span>    <span class="p">],</span>
<span class="linenos">131</span><span class="p">}</span>
<span class="linenos">132</span>
<span class="linenos">133</span><span class="n">block_diff</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">134</span>    <span class="s2">&quot;block_type&quot;</span><span class="p">:</span> <span class="s2">&quot;type_1&quot;</span><span class="p">,</span>
<span class="linenos">135</span>    <span class="s2">&quot;f1_params&quot;</span><span class="p">:</span> <span class="n">leftpdf</span><span class="p">,</span>
<span class="linenos">136</span>    <span class="s2">&quot;f2_params&quot;</span><span class="p">:</span> <span class="n">delta</span><span class="p">,</span>
<span class="linenos">137</span>    <span class="s2">&quot;f3_params&quot;</span><span class="p">:</span> <span class="n">rightpdf</span><span class="p">,</span>
<span class="linenos">138</span>    <span class="s2">&quot;proportion&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
<span class="linenos">139</span>    <span class="s2">&quot;isopleth_values&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">),</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)]],</span>
<span class="linenos">140</span><span class="p">}</span>
<span class="linenos">141</span>
<span class="linenos">142</span>
<span class="linenos">143</span><span class="n">main_params</span> <span class="o">=</span> <span class="p">{</span>
<span class="linenos">144</span>    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;ex_zscore.pdf&quot;</span><span class="p">,</span>
<span class="linenos">145</span>    <span class="s2">&quot;paper_height&quot;</span><span class="p">:</span> <span class="mf">11.0</span> <span class="o">*</span> <span class="mf">2.54</span><span class="p">,</span>
<span class="linenos">146</span>    <span class="s2">&quot;paper_width&quot;</span><span class="p">:</span> <span class="mf">8.5</span> <span class="o">*</span> <span class="mf">2.54</span><span class="p">,</span>
<span class="linenos">147</span>    <span class="s2">&quot;block_params&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">block_diff</span><span class="p">,</span> <span class="n">leftblock2</span><span class="p">,</span> <span class="n">rightblock2</span><span class="p">],</span>
<span class="linenos">148</span>    <span class="s2">&quot;cdfations&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;rotate&quot;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;scale paper&quot;</span><span class="p">,),</span> <span class="p">(</span><span class="s2">&quot;polygon&quot;</span><span class="p">,)],</span>
<span class="linenos">149</span>    <span class="s2">&quot;title_x&quot;</span><span class="p">:</span> <span class="mf">11.0</span><span class="p">,</span>
<span class="linenos">150</span>    <span class="s2">&quot;title_y&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="linenos">151</span>    <span class="s2">&quot;title_box_width&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
<span class="linenos">152</span>    <span class="s2">&quot;title_str&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\Huge Z Score Nomograph \par \medskip \large ($\mu = 0$, $\sigma = 1$) \par \medskip  \small \copyright Daniel Boulet  2021&quot;</span><span class="p">,</span>
<span class="linenos">153</span>    <span class="c1"># &#39;make_grid&#39;:True,</span>
<span class="linenos">154</span>    <span class="s2">&quot;extra_texts&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="linenos">155</span>        <span class="p">{</span>
<span class="linenos">156</span>            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>
<span class="linenos">157</span>            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">,</span>
<span class="linenos">158</span>            <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;\noindent Area under normal curve between lower tail $X_1$ and upper tail $X_2$ is read on center axis. </span><span class="se">\</span>
<span class="linenos">159</span><span class="s2">                For example, area under normal distribution curve from $</span><span class="si">%g</span><span class="s2"> \sigma$ to $</span><span class="si">%g</span><span class="s2"> \sigma$ is $</span><span class="si">%4.4f</span><span class="s2">$.&quot;</span>
<span class="linenos">160</span>            <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">cdf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">)),</span>
<span class="linenos">161</span>            <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
<span class="linenos">162</span>        <span class="p">},</span>
<span class="linenos">163</span>    <span class="p">],</span>
<span class="linenos">164</span><span class="p">}</span>
<span class="linenos">165</span>
<span class="linenos">166</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="example-amortized-loan-calculator">
<h2>Example: Amortized loan calculator<a class="headerlink" href="#example-amortized-loan-calculator" title="Permalink to this headline">¶</a></h2>
<section id="id15">
<h3>Theory and background<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>This approach of constructing an amortized loan calculator is similar to
one in Ref.  <span id="id16">[<a class="reference internal" href="../appendix/bibliography.html#id20" title="Maurice d'Ocagne. Traite de Nomographie. Gauthier-Villars, Paris, 1. aufl edition, 1899.">dOcagne99</a>]</span></p>
<p>Equation for amortized loan  <span id="id17">[<a class="reference internal" href="../appendix/bibliography.html#id22" title="Amortization calculator. November 2021. Page Version ID: 1053939556. URL: https://en.wikipedia.org/w/index.php?title=Amortization_calculator&amp;oldid=1053939556 (visited on 2021-12-31).">wik21a</a>]</span> is:</p>
<p><span class="math notranslate nohighlight">\(\frac{a}{A} = \frac{\frac{p}{100\times 12}}{1-\frac{1}{(1+\frac{p}{100\times 12})^{12n}}},\)</span></p>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the amount of loan, <span class="math notranslate nohighlight">\(a\)</span> is monthly payment
amount, <span class="math notranslate nohighlight">\(p\)</span> interest rate per year (monthly interest rate is taken
as <span class="math notranslate nohighlight">\(p/12\)</span>) <span id="id18">[<a class="reference internal" href="../appendix/bibliography.html#id21" title="Annual percentage rate. October 2021. Page Version ID: 1048227598. URL: https://en.wikipedia.org/w/index.php?title=Annual_percentage_rate&amp;oldid=1048227598 (visited on 2021-12-31).">wik21b</a>]</span> and <span class="math notranslate nohighlight">\(n\)</span> is number of years for payment.</p>
<p>This equation of four variables is probably impossible to present with
line and grid nomographs. For this reason a “Type 5” contour nomogram is
constructed of the right hand side of the equation and left hand
equation is just N-nomogram (Type 2). The two equations for nomogram
construction are:</p>
<p><span class="math notranslate nohighlight">\(x = \frac{a}{A}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(x = \frac{\frac{p}{100\times 12}}{1-\frac{1}{(1+\frac{p}{100\times 12})^{12n}}}.\)</span></p>
<p>In practice <span class="math notranslate nohighlight">\(x\)</span> is the x-coordinate of the canvas where nomogram
is constructed.</p>
<section id="right-hand-side-of-equation">
<h4>Right hand side of equation<a class="headerlink" href="#right-hand-side-of-equation" title="Permalink to this headline">¶</a></h4>
<p>By defining coordinates <span class="math notranslate nohighlight">\(x\,\)</span> and <span class="math notranslate nohighlight">\(y\,\)</span>:</p>
<p><span class="math notranslate nohighlight">\(x = \frac{\frac{p}{100\times 12}}{1-\frac{1}{(1+\frac{p}{100\times 12})^{12n}}},\)</span></p>
<p><span class="math notranslate nohighlight">\(y = 12n, \,\)</span> we may solve <span class="math notranslate nohighlight">\(y\,\)</span> in terms of <span class="math notranslate nohighlight">\(x\,\)</span> and
<span class="math notranslate nohighlight">\(n\,\)</span>:</p>
<p><span class="math notranslate nohighlight">\(y = \frac{\log (\frac{x}{x-\frac{p}{100\times 12}})}{\log (1+\frac{p}{100 \times 12})} \,\)</span></p>
<p>The previous two equations are of correct form</p>
<p><span class="math notranslate nohighlight">\(y = f_1(v) \,\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(y = f_2(x,u) \,\)</span></p>
<p>for type 5 nomogram. For compressing time axis (<span class="math notranslate nohighlight">\(y\)</span>-axis), we
transform <span class="math notranslate nohighlight">\(y \rightarrow \log y\)</span> and find</p>
<p><span class="math notranslate nohighlight">\(y = \log \left( \frac{\log (\frac{x}{x-\frac{p}{100\times 12}})}{\log (1+\frac{p}{100 \times 12})} \right)\,\)</span></p>
<p><span class="math notranslate nohighlight">\(y = \log( 12n ). \,\)</span></p>
</section>
<section id="left-hand-side-of-equation">
<h4>Left hand side of equation<a class="headerlink" href="#left-hand-side-of-equation" title="Permalink to this headline">¶</a></h4>
<p>Left hand side of equation</p>
<p><span class="math notranslate nohighlight">\(x = \frac{a}{A}\)</span></p>
<p>is just N-nomogram</p>
<p><span class="math notranslate nohighlight">\(F_1(u_1) = F_2(u_2)F_3(u_3) \,\)</span></p>
</section>
<section id="references">
<h4>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h4>
<references /></section>
</section>
<section id="id19">
<h3>Generated nomograph<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/amortized_loan.png" src="../_images/amortized_loan.png" />
</section>
<section id="id20">
<h3>Source code<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 2</span><span class="sd">    ex_amortized_loan.py</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="sd">    Amortized loan calculator</span>
<span class="linenos"> 5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 7</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Type 5 contour</span>
<span class="linenos">11</span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">):</span>
<span class="linenos">12</span>    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">u</span><span class="o">/</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="mf">12.0</span><span class="p">)))</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="o">/</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="mf">12.0</span><span class="p">)))</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">block_1_params</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">15</span>            <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">16</span>           <span class="s1">&#39;height&#39;</span><span class="p">:</span><span class="mf">5.0</span><span class="p">,</span>
<span class="linenos">17</span>           <span class="s1">&#39;block_type&#39;</span><span class="p">:</span><span class="s1">&#39;type_5&#39;</span><span class="p">,</span>
<span class="linenos">18</span>           <span class="s1">&#39;u_func&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">log</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="mf">12.0</span><span class="p">),</span>
<span class="linenos">19</span>           <span class="s1">&#39;v_func&#39;</span><span class="p">:</span><span class="n">f1</span><span class="p">,</span>
<span class="linenos">20</span>           <span class="s1">&#39;u_values&#39;</span><span class="p">:[</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">11.0</span><span class="p">,</span><span class="mf">12.0</span><span class="p">,</span><span class="mf">13.0</span><span class="p">,</span><span class="mf">14.0</span><span class="p">,</span><span class="mf">15.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mf">30.0</span><span class="p">,</span><span class="mf">40.0</span><span class="p">,</span><span class="mf">50.0</span><span class="p">,</span><span class="mf">60.0</span><span class="p">],</span>
<span class="linenos">21</span>           <span class="s1">&#39;v_values&#39;</span><span class="p">:[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">,</span><span class="mf">7.0</span><span class="p">,</span><span class="mf">8.0</span><span class="p">,</span><span class="mf">9.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">],</span>
<span class="linenos">22</span>           <span class="s1">&#39;wd_tag&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
<span class="linenos">23</span>           <span class="s1">&#39;u_title&#39;</span><span class="p">:</span><span class="s1">&#39;years&#39;</span><span class="p">,</span>
<span class="linenos">24</span>           <span class="s1">&#39;v_title&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;interest rate = &#39;</span><span class="p">,</span>
<span class="linenos">25</span>           <span class="s1">&#39;u_text_format&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s2">&quot;$</span><span class="si">%3.0f</span><span class="s2">$ &quot;</span><span class="p">,</span>
<span class="linenos">26</span>           <span class="s1">&#39;v_text_format&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s2">&quot;$</span><span class="si">%3.0f</span><span class="s2">$ \</span><span class="si">%%</span><span class="s2"> &quot;</span><span class="p">,</span>
<span class="linenos">27</span>           <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:[[</span><span class="mi">21</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span>
<span class="linenos">28</span>             <span class="p">}</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="c1"># this is non-obvious trick to find bottom edge coordinates of the grid in order</span>
<span class="linenos">31</span><span class="c1"># to align it with N nomogram</span>
<span class="linenos">32</span><span class="n">block1_dummy</span><span class="o">=</span><span class="n">Nomo_Block_Type_5</span><span class="p">(</span><span class="n">mirror_x</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">33</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">define_block</span><span class="p">(</span><span class="n">block_1_params</span><span class="p">)</span>
<span class="linenos">34</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">set_block</span><span class="p">()</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="c1"># Let&#39;s define the N-nomogram</span>
<span class="linenos">37</span><span class="n">N_params_3</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">38</span>        <span class="s1">&#39;u_min&#39;</span><span class="p">:</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">grid_box</span><span class="o">.</span><span class="n">params_wd</span><span class="p">[</span><span class="s1">&#39;u_min&#39;</span><span class="p">],</span>
<span class="linenos">39</span>        <span class="s1">&#39;u_max&#39;</span><span class="p">:</span><span class="n">block1_dummy</span><span class="o">.</span><span class="n">grid_box</span><span class="o">.</span><span class="n">params_wd</span><span class="p">[</span><span class="s1">&#39;u_max&#39;</span><span class="p">],</span>
<span class="linenos">40</span>        <span class="s1">&#39;function&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="p">,</span>
<span class="linenos">41</span>        <span class="s1">&#39;title&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">42</span>        <span class="s1">&#39;tag&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
<span class="linenos">43</span>        <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">44</span>        <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">45</span>        <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">46</span>        <span class="s1">&#39;reference&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">47</span>        <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="linenos">48</span>        <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="linenos">49</span>        <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span><span class="kc">True</span>
<span class="linenos">50</span>                <span class="p">}</span>
<span class="linenos">51</span><span class="n">N_params_2</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">52</span>        <span class="s1">&#39;u_min&#39;</span><span class="p">:</span><span class="mf">30.0</span><span class="p">,</span>
<span class="linenos">53</span>        <span class="s1">&#39;u_max&#39;</span><span class="p">:</span><span class="mf">1000.0</span><span class="p">,</span>
<span class="linenos">54</span>        <span class="s1">&#39;function&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="p">,</span>
<span class="linenos">55</span>        <span class="s1">&#39;title&#39;</span><span class="p">:</span><span class="s1">&#39;Loan&#39;</span><span class="p">,</span>
<span class="linenos">56</span>        <span class="s1">&#39;tag&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="linenos">57</span>        <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos">58</span>        <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
<span class="linenos">59</span>        <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
<span class="linenos">60</span>        <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span>
<span class="linenos">61</span>        <span class="c1">#&#39;text_format&#39;:r&quot;$%3.0f$ &quot;,</span>
<span class="linenos">62</span>        <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span><span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos">63</span>                <span class="p">}</span>
<span class="linenos">64</span><span class="n">N_params_1</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">65</span>        <span class="s1">&#39;u_min&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
<span class="linenos">66</span>        <span class="s1">&#39;u_max&#39;</span><span class="p">:</span><span class="mf">3.0</span><span class="p">,</span>
<span class="linenos">67</span>        <span class="s1">&#39;function&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="p">,</span>
<span class="linenos">68</span>        <span class="s1">&#39;title&#39;</span><span class="p">:</span><span class="s1">&#39;monthly payment&#39;</span><span class="p">,</span>
<span class="linenos">69</span>        <span class="s1">&#39;tag&#39;</span><span class="p">:</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="linenos">70</span>        <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">71</span>        <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
<span class="linenos">72</span>        <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">73</span>        <span class="s1">&#39;title_draw_center&#39;</span><span class="p">:</span><span class="kc">True</span>
<span class="linenos">74</span>                <span class="p">}</span>
<span class="linenos">75</span>
<span class="linenos">76</span><span class="n">block_2_params</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">77</span>             <span class="s1">&#39;block_type&#39;</span><span class="p">:</span><span class="s1">&#39;type_2&#39;</span><span class="p">,</span>
<span class="linenos">78</span>             <span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">79</span>             <span class="s1">&#39;height&#39;</span><span class="p">:</span><span class="mf">20.0</span><span class="p">,</span>
<span class="linenos">80</span>             <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span><span class="n">N_params_1</span><span class="p">,</span>
<span class="linenos">81</span>             <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span><span class="n">N_params_2</span><span class="p">,</span>
<span class="linenos">82</span>             <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span><span class="n">N_params_3</span><span class="p">,</span>
<span class="linenos">83</span>             <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span>
<span class="linenos">84</span>             <span class="p">}</span>
<span class="linenos">85</span>
<span class="linenos">86</span><span class="n">main_params</span><span class="o">=</span><span class="p">{</span>
<span class="linenos">87</span>              <span class="s1">&#39;filename&#39;</span><span class="p">:</span><span class="s1">&#39;amortized_loan.pdf&#39;</span><span class="p">,</span>
<span class="linenos">88</span>              <span class="s1">&#39;paper_height&#39;</span><span class="p">:</span><span class="mf">20.0</span><span class="p">,</span>
<span class="linenos">89</span>              <span class="s1">&#39;paper_width&#39;</span><span class="p">:</span><span class="mf">20.0</span><span class="p">,</span>
<span class="linenos">90</span>              <span class="s1">&#39;block_params&#39;</span><span class="p">:[</span><span class="n">block_1_params</span><span class="p">,</span><span class="n">block_2_params</span><span class="p">],</span>
<span class="linenos">91</span>              <span class="s1">&#39;transformations&#39;</span><span class="p">:[(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),(</span><span class="s1">&#39;scale paper&#39;</span><span class="p">,)],</span>
<span class="linenos">92</span>                <span class="s1">&#39;title_str&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;Amortized loan calculator    \copyright    Leif Roschier  2009&#39;</span><span class="p">,</span>
<span class="linenos">93</span>                <span class="s1">&#39;title_x&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
<span class="linenos">94</span>                <span class="s1">&#39;title_y&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
<span class="linenos">95</span>                <span class="s1">&#39;title_box_width&#39;</span><span class="p">:</span> <span class="mi">5</span>
<span class="linenos">96</span>              <span class="p">}</span>
<span class="linenos">97</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="example-photography-exposure">
<h2>Example Photography exposure<a class="headerlink" href="#example-photography-exposure" title="Permalink to this headline">¶</a></h2>
<section id="id21">
<h3>Theory and background<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>This example illustrates how exposure in photography depends on factors:
latitude, time of day, day of year, weather, composition. It relates
these to camera settings: film speed (e.g. ISO 100), aperture and
shutter speed. The mathematical approach and model is taken from book
written by V. Setälä <span id="id22">[<a class="reference internal" href="../appendix/bibliography.html#id23" title="Vilho Setälä. Valokuvaus tieteenä ja taiteena. Otava, 1940.">Set40</a>]</span>. This book illustrates the approach as
nomographs but they are different compared with the one generatated
here. Book uses shadow length, but we break shadow length into time,
date and latitude via solar zenith angle.</p>
<p>The basic equation in Setälä (pp.492-494) can be extracted and
written as</p>
<div class="math notranslate nohighlight" id="equation-setala1">
<span class="eqno">(1)<a class="headerlink" href="#equation-setala1" title="Permalink to this equation">¶</a></span>\[FS-L-A-W+C+T=0 \,\]</div>
<p>where parameters of <a class="reference internal" href="photo_part.html#equation-setala1">(1)</a> are listed below:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 25%" />
<col style="width: 63%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(FS\,\)</span></p></td>
<td><p>Film speed</p></td>
<td><p>DIN value that equals <span class="math notranslate nohighlight">\(10 \log (S) +1 \,\)</span>,where S is ISO FILM speed</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(T\,\)</span></p></td>
<td><p>shutter time</p></td>
<td><p><span class="math notranslate nohighlight">\(10 \log \left( \frac{t}{1/10}\right)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A\,\)</span></p></td>
<td><p>aperture</p></td>
<td><p><span class="math notranslate nohighlight">\(10 \log \left(\frac{N^2}{3.2^2}\right)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(L\,\)</span></p></td>
<td><p>shadow length (in steps)</p></td>
<td><p>two times (shadow length)/(person length) <span class="math notranslate nohighlight">\(= 2 \arctan ( \phi) \,\)</span>, where <span class="math notranslate nohighlight">\(\phi \,\)</span> is solar zenith angle.</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(W\,\)</span></p></td>
<td><p>weather</p></td>
<td><p>Clear sky, Cumulus clouds: 0, Clear sky: 1, Sun through clouds: 3, Sky light gray: 6, Sky dark gray: 9, Thunder-clouds cover sky: 12</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C\,\)</span></p></td>
<td><p>Composition</p></td>
<td><p>Person under trees: -6, Inside forest : -4, Person in shadow of wall : -1, Person at open place; alley under trees : 2, Buildings; street : 5, Landscape and front matter : 7, Open landscape : 9, Snow landscape and front matter; beach : 11,Snow field; open sea : 13, Clouds : 15</p></td>
</tr>
</tbody>
</table>
<p>It is to be noted that Setälä has stops ten times base-10 logarithmic.
Today we think stops in base-2 logarithmic.</p>
<section id="shadow-lenght">
<h4>Shadow lenght<a class="headerlink" href="#shadow-lenght" title="Permalink to this headline">¶</a></h4>
<p>Calculation of shadow length as a function of day of year, time of day
and latitude is according to <span id="id23">[<a class="reference internal" href="../appendix/bibliography.html#id24" title="General solar position calculations. URL: https://www.esrl.noaa.gov/gmd/grad/solcalc/solareqns.PDF.">sol</a>]</span>. Following equations are used. For
fractional year (without time information) we take</p>
<p><span class="math notranslate nohighlight">\(\gamma = (day-1+0.5)2\pi /365.\)</span></p>
<p>For time offset (eqtime) we use equation (in minutes)</p>
<p><span class="math notranslate nohighlight">\(TO = 229.18(0.000075+0.001868\cos(\gamma)-0.032077\sin(\gamma)-0.014615\cos(2\gamma)-0.040849\sin(2\gamma))\)</span></p>
<p>to calculate that error is below 17 minutes for time axis. We assume
that sun is at heightest point at noon and this is the error and
approximation. We calculate stops in logarithmic scale and in this case
we do not need very accurate equations for time. For declination we use
equation</p>
<p>and for hour angle</p>
<p><span class="math notranslate nohighlight">\(ha=(60h+\overline{TO})/4-180. \,\)</span></p>
<p>Solar zenith angle (<span class="math notranslate nohighlight">\(\phi \,\)</span>), latitude (LAT),
declination (D) and hour angle (ha) are connected with equation:</p>
<p><span class="math notranslate nohighlight">\(\cos (\phi ) = \sin(LAT)sin(D)+\cos(LAT)\cos(D)\cos(ha). \,\)</span></p>
<p>This is in our desired form as a function of hour (h), day (day),
latitude (LAT), solar zenith angle (<span class="math notranslate nohighlight">\(\phi \,\)</span>):</p>
<p><span class="math notranslate nohighlight">\(\cos (\phi ) = \sin(LAT)sin(D(\gamma(day)))+\cos(LAT)\cos(D(\gamma(day)))\cos(ha(h)) \,\)</span>.</p>
<p>In practice illuminance of flat surface on earth depends on solar zenith
angle as <span class="math notranslate nohighlight">\(\cos(\phi)\,\)</span>. Setälä uses shadow length that is
easily measurable, but scales incorrectly, as value is proportional to
<span class="math notranslate nohighlight">\(\tan(\phi)\,\)</span>. Also Setälä sums linear value with
logarithmic ones as a practical approximation. To correct these
assumptions, here we assume that values for shadow length 1 and 10 for Setälä
are reasonable, and an equation that scales logarithmically is found:</p>
<p><span class="math notranslate nohighlight">\(L = 0.33766 - 13.656 \log10 (\cos(\phi)) \,\)</span></p>
<p>that gives <span class="math notranslate nohighlight">\(L=1\,\)</span> for <span class="math notranslate nohighlight">\(\phi = 26.565 =\arctan(1/2)\,\)</span> and <span class="math notranslate nohighlight">\(L=10\,\)</span> for <span class="math notranslate nohighlight">\(\phi = 78.69 =\arctan(10/2).\,\)</span></p>
</section>
</section>
<section id="construction-of-the-nomograph">
<h3>Construction of the nomograph<a class="headerlink" href="#construction-of-the-nomograph" title="Permalink to this headline">¶</a></h3>
<p>The presented equation is the following:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
    FS - \{0.33766 - 13.656 \log_{10}[ \sin (LAT)\sin (D(\gamma(day)))+\cos (LAT)\cos (D(\gamma(day)))\cos (ha(h))]\}\\
    - A - W + C + T = 0.
\end{eqnarray*}</div><p>In order to construct the nomograph, we split the equation into four blocks and an additional block to present values as EV100.</p>
<table class="colwidths-given longtable docutils align-default" id="id26">
<caption><span class="caption-text">Main equation split into blocks for the nomograph.</span><a class="headerlink" href="#id26" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Explanation</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="math notranslate nohighlight">
\[x_1 \equiv \cos(\phi)=\sin(LAT)sin(D(\gamma(day)))+\cos(LAT)\cos(D(\gamma(day)))\cos(ha(h))\,\]</div>
<p>formed into determinant:</p>
<div class="math notranslate nohighlight">
\[\begin{split}{{
\begin{vmatrix}
        0  &amp; \cos(\phi) &amp; 1 \\
       \frac{\cos(LAT)\cos(D(\gamma(day)))}{1+(\cos(LAT)\cos(D(\gamma(day))))}  &amp; \frac{\sin(LAT)\sin(D(\gamma(day)))}{1+(\cos(LAT)\cos(D(\gamma(day))))} &amp; 1 \\
       1  &amp; -\cos(ha(h)) &amp; 1 \\
\end{vmatrix} = 0
}}\end{split}\]</div>
</td>
<td><p>Type 9</p></td>
</tr>
<tr class="row-odd"><td><div class="math notranslate nohighlight">
\[C_1 \equiv L+W = 0.006918-13.656 \log_{10}(x_1)+W\]</div>
<p>split into two equations for contour construction:</p>
<div class="math notranslate nohighlight">
\[y_1 = C_1 \,\]</div>
<div class="math notranslate nohighlight">
\[y_1 = 0.006918-13.656  \log_{10}(x_1)+W\]</div>
</td>
<td><p>Type 5</p></td>
</tr>
<tr class="row-even"><td><div class="math notranslate nohighlight">
\[C_2 \equiv L+W+C = C_1+C\]</div>
<p>split into two equations for contour construction:</p>
<div class="math notranslate nohighlight">
\[y_2 = C_2\]</div>
<div class="math notranslate nohighlight">
\[y_2 = C_1+C\]</div>
</td>
<td><p>Type 5</p></td>
</tr>
<tr class="row-odd"><td><div class="math notranslate nohighlight">
\[C_2 = FS-A+T\]</div>
<p>equals</p>
<div class="math notranslate nohighlight">
\[C_2 -(10 \log_{10}(S)+1.0)+10 \log_{10}\left(\frac{N^2}{3.2^2} \right)-10 \log_{10}\left( \frac{1/t_i}{1/10}\right)=0,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[t_i\equiv 1/t\]</div>
<p>is inverse shutter time.</p>
</td>
<td><p>Type 3</p></td>
</tr>
<tr class="row-even"><td><p>Additional EV100 scale by using relation</p>
<div class="math notranslate nohighlight">
\[C_2 =(-EV_{100}+13.654)/0.3322\]</div>
</td>
<td><p>Type 8</p></td>
</tr>
<tr class="row-odd"><td><p>Maximum focal length calculator according to equation</p>
<div class="math notranslate nohighlight">
\[t_i / f = FL\]</div>
<p>written as</p>
<div class="math notranslate nohighlight">
\[-10 \log_{10}\left( \frac{1/t_i}{1/10}\right) - 10 \log_{10}\left( \frac{f}{10} \right)  -10 \log_{10}\left( FL \right) = 0\]</div>
<p>in order to align correctly with previous equation.  The values for the factor f  are: DSLR (3/2), 35mm (1),
DSLR image stabilization (3/8) and 35mm image stabilization (1/8).</p>
</td>
<td><p>Type 1</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id24">
<h3>Generated nomograph<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<img alt="../_images/ex_photo_exposure.png" src="../_images/ex_photo_exposure.png" />
</section>
<section id="id25">
<h3>Source code<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  2</span><span class="sd">    ex_photo_exposure.py</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="sd">    Photgraph exposure.</span>
<span class="linenos">  5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  6</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos">  7</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
<span class="linenos">  8</span><span class="kn">from</span> <span class="nn">pynomo.nomographer</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">  9</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 10</span><span class="sd">functions for solartime taken from solareqns.pdf from</span>
<span class="linenos"> 11</span><span class="sd">http://www.srrb.noaa.gov/highlights/sunrise/solareqns.PDF</span>
<span class="linenos"> 12</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="c1"># fractional year</span>
<span class="linenos"> 16</span><span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
<span class="linenos"> 17</span>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">365.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">day</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="linenos"> 18</span><span class="c1"># equation of time</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span><span class="k">def</span> <span class="nf">eq_time</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
<span class="linenos"> 22</span>    <span class="n">gamma0</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<span class="linenos"> 23</span>    <span class="k">return</span> <span class="mf">229.18</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.000075</span> <span class="o">+</span> <span class="mf">0.001868</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">gamma0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.032077</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">gamma0</span><span class="p">)</span>\
<span class="linenos"> 24</span>                   <span class="o">-</span> <span class="mf">0.014615</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.040849</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma0</span><span class="p">))</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="c1"># mean correction, with constant correction we make less than 17 minutes  error</span>
<span class="linenos"> 27</span><span class="c1"># in time axis</span>
<span class="linenos"> 28</span><span class="n">temp_a</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">365.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="linenos"> 29</span><span class="n">temp_b</span> <span class="o">=</span> <span class="n">eq_time</span><span class="p">(</span><span class="n">temp_a</span><span class="p">)</span>
<span class="linenos"> 30</span><span class="n">correction</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">temp_b</span><span class="p">)</span> <span class="c1"># this is 0.0171885 minutes</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="c1"># declination</span>
<span class="linenos"> 34</span><span class="k">def</span> <span class="nf">eq_declination</span><span class="p">(</span><span class="n">day</span><span class="p">):</span>
<span class="linenos"> 35</span>    <span class="n">g0</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<span class="linenos"> 36</span>    <span class="k">return</span> <span class="mf">0.006918</span> <span class="o">-</span> <span class="mf">0.399912</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">g0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.070257</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">g0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.006758</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g0</span><span class="p">)</span>\
<span class="linenos"> 37</span>            <span class="o">+</span> <span class="mf">0.000907</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.002697</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">g0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00148</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">g0</span><span class="p">)</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">dummy</span><span class="p">):</span>
<span class="linenos"> 41</span>    <span class="k">return</span> <span class="mf">0.0</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="k">def</span> <span class="nf">g1</span><span class="p">(</span><span class="n">fii</span><span class="p">):</span>
<span class="linenos"> 45</span>    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">fii</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">)</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
<span class="linenos"> 49</span>    <span class="n">dec</span> <span class="o">=</span> <span class="n">eq_declination</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
<span class="linenos"> 50</span>    <span class="k">return</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)))</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span>
<span class="linenos"> 53</span><span class="k">def</span> <span class="nf">g2</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
<span class="linenos"> 54</span>    <span class="n">dec</span> <span class="o">=</span> <span class="n">eq_declination</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>  <span class="c1"># in radians</span>
<span class="linenos"> 55</span>    <span class="k">return</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)))</span>
<span class="linenos"> 56</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span><span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">dummy</span><span class="p">):</span>
<span class="linenos"> 59</span>    <span class="k">return</span> <span class="mi">1</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span><span class="k">def</span> <span class="nf">g3</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
<span class="linenos"> 63</span>    <span class="n">hr</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="mf">60.0</span> <span class="o">+</span> <span class="n">correction</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span> <span class="o">-</span> <span class="mf">180.0</span>
<span class="linenos"> 64</span>    <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">hr</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span><span class="p">)</span>
<span class="linenos"> 65</span>
<span class="linenos"> 66</span><span class="n">days_in_month</span> <span class="o">=</span> <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="linenos"> 67</span><span class="n">times1</span><span class="o">=</span><span class="p">[]</span>
<span class="linenos"> 68</span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>
<span class="linenos"> 69</span>    <span class="n">times1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">days_in_month</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">idx</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span><span class="n">time_titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span> <span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span>
<span class="linenos"> 72</span>               <span class="s1">&#39;July&#39;</span><span class="p">,</span> <span class="s1">&#39;August&#39;</span><span class="p">,</span> <span class="s1">&#39;September&#39;</span><span class="p">,</span> <span class="s1">&#39;October&#39;</span><span class="p">,</span> <span class="s1">&#39;November&#39;</span><span class="p">,</span> <span class="s1">&#39;December&#39;</span><span class="p">]</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span><span class="n">phi_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos"> 75</span>              <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
<span class="linenos"> 76</span>              <span class="s1">&#39;u_min_trafo&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos"> 77</span>              <span class="s1">&#39;u_max_trafo&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
<span class="linenos"> 78</span>              <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
<span class="linenos"> 79</span>              <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="n">g1</span><span class="p">,</span>
<span class="linenos"> 80</span>              <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos"> 81</span>              <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Solar zenith angle $\phi$&#39;</span><span class="p">,</span>
<span class="linenos"> 82</span>              <span class="s1">&#39;title_x_shift&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos"> 83</span>              <span class="s1">&#39;title_y_shift&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
<span class="linenos"> 84</span>              <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear smart&#39;</span><span class="p">,</span>
<span class="linenos"> 85</span>              <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 86</span>              <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 87</span>              <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos"> 88</span>              <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span>
<span class="linenos"> 89</span>              <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos"> 90</span>              <span class="p">}</span>
<span class="linenos"> 91</span><span class="n">time_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos"> 92</span>               <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">23.0</span><span class="p">,</span>
<span class="linenos"> 93</span>               <span class="s1">&#39;u_min_trafo&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos"> 94</span>               <span class="s1">&#39;u_max_trafo&#39;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span>
<span class="linenos"> 95</span>               <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="n">f3</span><span class="p">,</span>
<span class="linenos"> 96</span>               <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="n">g3</span><span class="p">,</span>
<span class="linenos"> 97</span>               <span class="s1">&#39;h&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos"> 98</span>               <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Hour (h)&#39;</span><span class="p">,</span>
<span class="linenos"> 99</span>               <span class="s1">&#39;title_x_shift&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos">100</span>               <span class="s1">&#39;title_y_shift&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
<span class="linenos">101</span>               <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="linenos">102</span>               <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">103</span>               <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos">104</span>               <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">105</span>               <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="linenos">106</span>               <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">107</span>               <span class="p">}</span>
<span class="linenos">108</span><span class="n">lat_day_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>  <span class="c1"># to identify the axis</span>
<span class="linenos">109</span>                  <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>  <span class="c1"># for aligning block wrt others</span>
<span class="linenos">110</span>                  <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Grid&#39;</span><span class="p">,</span>
<span class="linenos">111</span>                  <span class="s1">&#39;title_x_shift&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos">112</span>                  <span class="s1">&#39;title_y_shift&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
<span class="linenos">113</span>                  <span class="s1">&#39;title_distance_center&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">114</span>                  <span class="s1">&#39;title_opposite_tick&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">115</span>                  <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>  <span class="c1"># for alignment</span>
<span class="linenos">116</span>                  <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">80.0</span><span class="p">,</span>  <span class="c1"># for alignment</span>
<span class="linenos">117</span>                  <span class="s1">&#39;f_grid&#39;</span><span class="p">:</span> <span class="n">f2</span><span class="p">,</span>
<span class="linenos">118</span>                  <span class="s1">&#39;g_grid&#39;</span><span class="p">:</span> <span class="n">g2</span><span class="p">,</span>
<span class="linenos">119</span>                  <span class="s1">&#39;h_grid&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">120</span>                  <span class="s1">&#39;u_start&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span>
<span class="linenos">121</span>                  <span class="s1">&#39;u_stop&#39;</span><span class="p">:</span> <span class="mf">80.0</span><span class="p">,</span>
<span class="linenos">122</span>                  <span class="s1">&#39;v_start&#39;</span><span class="p">:</span> <span class="n">times1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># day</span>
<span class="linenos">123</span>                  <span class="s1">&#39;v_stop&#39;</span><span class="p">:</span> <span class="n">times1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">124</span>                  <span class="s1">&#39;u_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">30.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">70.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">],</span>
<span class="linenos">125</span>                  <span class="s1">&#39;u_texts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;30&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude = 60&#39;</span><span class="p">,</span> <span class="s1">&#39;70&#39;</span><span class="p">,</span> <span class="s1">&#39;80&#39;</span><span class="p">],</span>
<span class="linenos">126</span>                  <span class="s1">&#39;v_values&#39;</span><span class="p">:</span> <span class="n">times1</span><span class="p">,</span>
<span class="linenos">127</span>                  <span class="s1">&#39;v_texts&#39;</span><span class="p">:</span> <span class="n">time_titles</span><span class="p">,</span>
<span class="linenos">128</span>                  <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">129</span>                  <span class="s1">&#39;text_prefix_u&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">130</span>                  <span class="s1">&#39;text_prefix_v&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">131</span>                  <span class="s1">&#39;text_distance&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">132</span>                  <span class="s1">&#39;v_texts_u_start&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">133</span>                  <span class="s1">&#39;v_texts_u_stop&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">134</span>                  <span class="s1">&#39;u_texts_v_start&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">135</span>                  <span class="s1">&#39;u_texts_v_stop&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">136</span>                  <span class="p">}</span>
<span class="linenos">137</span><span class="n">block_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_9&#39;</span><span class="p">,</span>
<span class="linenos">138</span>                <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span> <span class="n">phi_params</span><span class="p">,</span>
<span class="linenos">139</span>                <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span> <span class="n">lat_day_params</span><span class="p">,</span>
<span class="linenos">140</span>                <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span> <span class="n">time_params</span><span class="p">,</span>
<span class="linenos">141</span>                <span class="s1">&#39;transform_ini&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">142</span>                <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="n">times1</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="mf">14.0</span><span class="p">]]</span>
<span class="linenos">143</span>                <span class="p">}</span>
<span class="linenos">144</span>
<span class="linenos">145</span>
<span class="linenos">146</span><span class="c1"># limiting functions are to avoid NaN in contour construction that uses optimization</span>
<span class="linenos">147</span><span class="k">def</span> <span class="nf">limit_xx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">148</span>    <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos">149</span>    <span class="k">return</span> <span class="n">x1</span>
<span class="linenos">150</span>
<span class="linenos">151</span>
<span class="linenos">152</span><span class="k">def</span> <span class="nf">limit_x</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="linenos">153</span>    <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span>
<span class="linenos">154</span>    <span class="k">return</span> <span class="n">x1</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="n">const_A</span> <span class="o">=</span> <span class="mf">0.33766</span>
<span class="linenos">157</span><span class="n">const_B</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.656</span>
<span class="linenos">158</span>
<span class="linenos">159</span><span class="n">block_params_weather</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_5&#39;</span><span class="p">,</span>
<span class="linenos">160</span>                        <span class="s1">&#39;u_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">161</span>                        <span class="s1">&#39;v_func&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">const_A</span> <span class="o">+</span> <span class="n">const_B</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span><span class="n">limit_x</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span>
<span class="linenos">162</span>                        <span class="s1">&#39;u_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">],</span>
<span class="linenos">163</span>                        <span class="s1">&#39;u_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">164</span>                                               <span class="mf">25.0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<span class="linenos">165</span>                        <span class="s1">&#39;v_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">],</span>
<span class="linenos">166</span>                        <span class="s1">&#39;v_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Clear sky, Cumulus clouds&#39;</span><span class="p">,</span>
<span class="linenos">167</span>                                                     <span class="p">{</span><span class="s1">&#39;x_corr&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">168</span>                                                      <span class="s1">&#39;y_corr&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="linenos">169</span>                                                      <span class="s1">&#39;draw_line&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}],</span>
<span class="linenos">170</span>                                               <span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;Clear sky&#39;</span><span class="p">,</span>
<span class="linenos">171</span>                                               <span class="mf">3.0</span><span class="p">:</span> <span class="s1">&#39;Sun through clouds&#39;</span><span class="p">,</span>
<span class="linenos">172</span>                                               <span class="mf">6.0</span><span class="p">:</span> <span class="s1">&#39;Sky light gray&#39;</span><span class="p">,</span>
<span class="linenos">173</span>                                               <span class="mf">9.0</span><span class="p">:</span> <span class="s1">&#39;Sky dark gray&#39;</span><span class="p">,</span>
<span class="linenos">174</span>                                               <span class="mf">12.0</span><span class="p">:</span> <span class="s1">&#39;Thunder-clouds cover sky&#39;</span><span class="p">},</span>
<span class="linenos">175</span>                        <span class="s1">&#39;v_text_distance&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">176</span>                        <span class="s1">&#39;wd_tick_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">177</span>                        <span class="s1">&#39;wd_tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">178</span>                        <span class="s1">&#39;wd_tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">179</span>                        <span class="s1">&#39;wd_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">180</span>                        <span class="s1">&#39;manual_x_scale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">181</span>                        <span class="s1">&#39;x_min&#39;</span><span class="p">:</span> <span class="mf">0.06</span><span class="p">,</span>
<span class="linenos">182</span>                        <span class="s1">&#39;x_max&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
<span class="linenos">183</span>                        <span class="s1">&#39;u_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">184</span>                        <span class="s1">&#39;v_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">185</span>                        <span class="s1">&#39;wd_title_opposite_tick&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">186</span>                        <span class="s1">&#39;wd_title_distance_center&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>
<span class="linenos">187</span>                        <span class="s1">&#39;wd_align_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="n">acos</span><span class="p">(</span><span class="n">limit_xx</span><span class="p">(</span><span class="mf">10.0</span><span class="o">**</span><span class="p">((</span><span class="n">L</span> <span class="o">-</span> <span class="n">const_A</span><span class="p">)</span> <span class="o">/</span> <span class="n">const_B</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">pi</span><span class="p">,</span>  <span class="c1"># phi as L</span>
<span class="linenos">188</span>                        <span class="s1">&#39;wd_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">((</span><span class="n">L</span> <span class="o">-</span> <span class="n">const_A</span><span class="p">)</span> <span class="o">/</span> <span class="n">const_B</span><span class="p">),</span>  <span class="c1"># x as L</span>
<span class="linenos">189</span>                        <span class="s1">&#39;wd_func_inv&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">const_A</span><span class="o">+</span><span class="n">const_B</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>  <span class="c1"># L as x</span>
<span class="linenos">190</span>                        <span class="s1">&#39;wd_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;phi&#39;</span><span class="p">,</span>
<span class="linenos">191</span>                        <span class="s1">&#39;mirror_y&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">192</span>                        <span class="s1">&#39;mirror_x&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="linenos">193</span>                        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">194</span>                        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">195</span>                        <span class="s1">&#39;u_scale_opposite&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">196</span>                        <span class="s1">&#39;u_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;AA&#39;</span><span class="p">,</span>
<span class="linenos">197</span>                        <span class="s1">&#39;horizontal_guides&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">198</span>                        <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos">199</span>                        <span class="p">}</span>
<span class="linenos">200</span><span class="n">block_params_scene</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_5&#39;</span><span class="p">,</span>
<span class="linenos">201</span>                      <span class="s1">&#39;u_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">202</span>                      <span class="s1">&#39;v_func&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span>
<span class="linenos">203</span>                      <span class="s1">&#39;u_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">],</span>
<span class="linenos">204</span>                      <span class="s1">&#39;u_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">205</span>                                             <span class="mf">25.0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
<span class="linenos">206</span>                      <span class="s1">&#39;u_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;AA&#39;</span><span class="p">,</span>
<span class="linenos">207</span>                      <span class="s1">&#39;wd_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;EV&#39;</span><span class="p">,</span>
<span class="linenos">208</span>                      <span class="s1">&#39;v_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">],</span>
<span class="linenos">209</span>                      <span class="s1">&#39;v_manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">-</span><span class="mf">6.0</span><span class="p">:</span> <span class="s1">&#39;Person under trees&#39;</span><span class="p">,</span>
<span class="linenos">210</span>                                             <span class="o">-</span><span class="mf">4.0</span><span class="p">:</span> <span class="s1">&#39;Inside forest&#39;</span><span class="p">,</span>
<span class="linenos">211</span>                                             <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;Person in shadow of wall&#39;</span><span class="p">,</span>
<span class="linenos">212</span>                                             <span class="mf">2.0</span><span class="p">:</span> <span class="s1">&#39;Person at open place; alley under trees&#39;</span><span class="p">,</span>
<span class="linenos">213</span>                                             <span class="mf">5.0</span><span class="p">:</span> <span class="s1">&#39;Buildings; street&#39;</span><span class="p">,</span>
<span class="linenos">214</span>                                             <span class="mf">7.0</span><span class="p">:</span> <span class="s1">&#39;Landscape and front matter&#39;</span><span class="p">,</span>
<span class="linenos">215</span>                                             <span class="mf">9.0</span><span class="p">:</span> <span class="s1">&#39;Open landscape&#39;</span><span class="p">,</span>
<span class="linenos">216</span>                                             <span class="mf">11.0</span><span class="p">:</span> <span class="s1">&#39;Snow landscape and front matter; beach&#39;</span><span class="p">,</span>
<span class="linenos">217</span>                                             <span class="mf">13.0</span><span class="p">:</span> <span class="s1">&#39;Snow field; open sea&#39;</span><span class="p">,</span>
<span class="linenos">218</span>                                             <span class="mf">15.0</span><span class="p">:</span> <span class="s1">&#39;Clouds&#39;</span><span class="p">,</span>
<span class="linenos">219</span>                                             <span class="p">},</span>
<span class="linenos">220</span>                      <span class="s1">&#39;wd_tick_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">221</span>                      <span class="s1">&#39;wd_tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">222</span>                      <span class="s1">&#39;wd_tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">223</span>                      <span class="s1">&#39;wd_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">224</span>                      <span class="s1">&#39;u_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">225</span>                      <span class="s1">&#39;v_title&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">226</span>                      <span class="s1">&#39;wd_title_opposite_tick&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">227</span>                      <span class="s1">&#39;wd_title_distance_center&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>
<span class="linenos">228</span>                      <span class="s1">&#39;mirror_x&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">229</span>                      <span class="s1">&#39;horizontal_guides&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">230</span>                      <span class="s1">&#39;u_align_y_offset&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span>
<span class="linenos">231</span>                      <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos">232</span>                      <span class="p">}</span>
<span class="linenos">233</span><span class="n">camera_params_1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">234</span>                   <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">,</span>
<span class="linenos">235</span>                   <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">,</span>
<span class="linenos">236</span>                   <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
<span class="linenos">237</span>                   <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">238</span>                   <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">239</span>                   <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;EV&#39;</span><span class="p">,</span>
<span class="linenos">240</span>                   <span class="p">}</span>
<span class="linenos">241</span><span class="n">camera_params_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">242</span>                   <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">25600.0</span><span class="p">,</span>
<span class="linenos">243</span>                   <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">S</span><span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">),</span>
<span class="linenos">244</span>                   <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Film speed&#39;</span><span class="p">,</span>
<span class="linenos">245</span>                   <span class="s1">&#39;manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">10.0</span><span class="p">:</span> <span class="s1">&#39;ISO 10&#39;</span><span class="p">,</span>
<span class="linenos">246</span>                                        <span class="mf">20.0</span><span class="p">:</span> <span class="s1">&#39;ISO 20&#39;</span><span class="p">,</span>
<span class="linenos">247</span>                                        <span class="mf">50.0</span><span class="p">:</span> <span class="s1">&#39;ISO 50&#39;</span><span class="p">,</span>
<span class="linenos">248</span>                                        <span class="mf">100.0</span><span class="p">:</span> <span class="s1">&#39;ISO 100&#39;</span><span class="p">,</span>
<span class="linenos">249</span>                                        <span class="mf">200.0</span><span class="p">:</span> <span class="s1">&#39;ISO 200&#39;</span><span class="p">,</span>
<span class="linenos">250</span>                                        <span class="mf">400.0</span><span class="p">:</span> <span class="s1">&#39;ISO 400&#39;</span><span class="p">,</span>
<span class="linenos">251</span>                                        <span class="mf">800.0</span><span class="p">:</span> <span class="s1">&#39;ISO 800&#39;</span><span class="p">,</span>
<span class="linenos">252</span>                                        <span class="mf">1600.0</span><span class="p">:</span> <span class="s1">&#39;ISO 1600&#39;</span><span class="p">,</span>
<span class="linenos">253</span>                                        <span class="mf">3200.0</span><span class="p">:</span> <span class="s1">&#39;ISO 3200&#39;</span><span class="p">,</span>
<span class="linenos">254</span>                                        <span class="mf">6400.0</span><span class="p">:</span> <span class="s1">&#39;ISO 6400&#39;</span><span class="p">,</span>
<span class="linenos">255</span>                                        <span class="mf">12800.0</span><span class="p">:</span> <span class="s1">&#39;ISO 12800&#39;</span><span class="p">,</span>
<span class="linenos">256</span>                                        <span class="mf">25600.0</span><span class="p">:</span> <span class="s1">&#39;ISO 25600&#39;</span><span class="p">,</span>
<span class="linenos">257</span>                                        <span class="p">},</span>
<span class="linenos">258</span>                   <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual line&#39;</span>
<span class="linenos">259</span>                   <span class="p">}</span>
<span class="linenos">260</span><span class="n">camera_params_3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="linenos">261</span>                   <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
<span class="linenos">262</span>                   <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span>
<span class="linenos">263</span>                   <span class="s1">&#39;manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="o">/</span><span class="mf">10.0</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
<span class="linenos">264</span>                                        <span class="mi">1</span><span class="o">/</span><span class="mf">7.0</span><span class="p">:</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span>
<span class="linenos">265</span>                                        <span class="mi">1</span><span class="o">/</span><span class="mf">5.0</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span>
<span class="linenos">266</span>                                        <span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span>
<span class="linenos">267</span>                                        <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="linenos">268</span>                                        <span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
<span class="linenos">269</span>                                        <span class="mf">2.0</span><span class="p">:</span> <span class="s1">&#39;1/2&#39;</span><span class="p">,</span>
<span class="linenos">270</span>                                        <span class="mf">3.0</span><span class="p">:</span> <span class="s1">&#39;1/3&#39;</span><span class="p">,</span>
<span class="linenos">271</span>                                        <span class="mf">5.0</span><span class="p">:</span> <span class="s1">&#39;1/5&#39;</span><span class="p">,</span>
<span class="linenos">272</span>                                        <span class="mf">7.0</span><span class="p">:</span> <span class="s1">&#39;1/7&#39;</span><span class="p">,</span>
<span class="linenos">273</span>                                        <span class="mf">10.0</span><span class="p">:</span> <span class="s1">&#39;1/10&#39;</span><span class="p">,</span>
<span class="linenos">274</span>                                        <span class="mf">20.0</span><span class="p">:</span> <span class="s1">&#39;1/20&#39;</span><span class="p">,</span>
<span class="linenos">275</span>                                        <span class="mf">30.0</span><span class="p">:</span> <span class="s1">&#39;1/30&#39;</span><span class="p">,</span>
<span class="linenos">276</span>                                        <span class="mf">50.0</span><span class="p">:</span> <span class="s1">&#39;1/50&#39;</span><span class="p">,</span>
<span class="linenos">277</span>                                        <span class="mf">70.0</span><span class="p">:</span> <span class="s1">&#39;1/70&#39;</span><span class="p">,</span>
<span class="linenos">278</span>                                        <span class="mf">100.0</span><span class="p">:</span> <span class="s1">&#39;1/100&#39;</span><span class="p">,</span>
<span class="linenos">279</span>                                        <span class="mf">200.0</span><span class="p">:</span> <span class="s1">&#39;1/200&#39;</span><span class="p">,</span>
<span class="linenos">280</span>                                        <span class="mf">300.0</span><span class="p">:</span> <span class="s1">&#39;1/300&#39;</span><span class="p">,</span>
<span class="linenos">281</span>                                        <span class="mf">500.0</span><span class="p">:</span> <span class="s1">&#39;1/500&#39;</span><span class="p">,</span>
<span class="linenos">282</span>                                        <span class="mf">700.0</span><span class="p">:</span> <span class="s1">&#39;1/700&#39;</span><span class="p">,</span>
<span class="linenos">283</span>                                        <span class="mf">1000.0</span><span class="p">:</span> <span class="s1">&#39;1/1000&#39;</span><span class="p">,</span>
<span class="linenos">284</span>                                        <span class="mf">2000.0</span><span class="p">:</span> <span class="s1">&#39;1/2000&#39;</span><span class="p">,</span>
<span class="linenos">285</span>                                        <span class="mf">3000.0</span><span class="p">:</span> <span class="s1">&#39;1/3000&#39;</span><span class="p">,</span>
<span class="linenos">286</span>                                        <span class="mf">5000.0</span><span class="p">:</span> <span class="s1">&#39;1/5000&#39;</span><span class="p">,</span>
<span class="linenos">287</span>                                        <span class="mf">7000.0</span><span class="p">:</span> <span class="s1">&#39;1/7000&#39;</span><span class="p">,</span>
<span class="linenos">288</span>                                        <span class="mf">10000.0</span><span class="p">:</span> <span class="s1">&#39;1/10000&#39;</span><span class="p">,</span>
<span class="linenos">289</span>                             <span class="p">},</span>
<span class="linenos">290</span>                   <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual line&#39;</span><span class="p">,</span>
<span class="linenos">291</span>                   <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span>
<span class="linenos">292</span>                   <span class="s1">&#39;text_format&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;1/</span><span class="si">%3.0f</span><span class="s2"> s&quot;</span><span class="p">,</span>
<span class="linenos">293</span>                   <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;shutter&#39;</span><span class="p">,</span>
<span class="linenos">294</span>                   <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos">295</span>                   <span class="p">}</span>
<span class="linenos">296</span><span class="n">camera_params_4</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="linenos">297</span>                   <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">22.0</span><span class="p">,</span>
<span class="linenos">298</span>                   <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">N</span><span class="p">:</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">((</span><span class="n">N</span> <span class="o">/</span> <span class="mf">3.2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>
<span class="linenos">299</span>                   <span class="s1">&#39;manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;$f$/1&#39;</span><span class="p">,</span>
<span class="linenos">300</span>                                        <span class="mf">1.2</span><span class="p">:</span> <span class="s1">&#39;$f$/1.2&#39;</span><span class="p">,</span>
<span class="linenos">301</span>                                        <span class="mf">1.4</span><span class="p">:</span> <span class="s1">&#39;$f$/1.4&#39;</span><span class="p">,</span>
<span class="linenos">302</span>                                        <span class="mf">1.7</span><span class="p">:</span> <span class="s1">&#39;$f$/1.7&#39;</span><span class="p">,</span>
<span class="linenos">303</span>                                        <span class="mf">2.0</span><span class="p">:</span> <span class="s1">&#39;$f$/2&#39;</span><span class="p">,</span>
<span class="linenos">304</span>                                        <span class="mf">2.4</span><span class="p">:</span> <span class="s1">&#39;$f$/2.4&#39;</span><span class="p">,</span>
<span class="linenos">305</span>                                        <span class="mf">2.8</span><span class="p">:</span> <span class="s1">&#39;$f$/2.8&#39;</span><span class="p">,</span>
<span class="linenos">306</span>                                        <span class="mf">3.3</span><span class="p">:</span> <span class="s1">&#39;$f$/3.3&#39;</span><span class="p">,</span>
<span class="linenos">307</span>                                        <span class="mf">4.0</span><span class="p">:</span> <span class="s1">&#39;$f$/4&#39;</span><span class="p">,</span>
<span class="linenos">308</span>                                        <span class="mf">4.8</span><span class="p">:</span> <span class="s1">&#39;$f$/4.8&#39;</span><span class="p">,</span>
<span class="linenos">309</span>                                        <span class="mf">5.6</span><span class="p">:</span> <span class="s1">&#39;$f$/5.6&#39;</span><span class="p">,</span>
<span class="linenos">310</span>                                        <span class="mf">6.7</span><span class="p">:</span> <span class="s1">&#39;$f$/6.7&#39;</span><span class="p">,</span>
<span class="linenos">311</span>                                        <span class="mf">8.0</span><span class="p">:</span> <span class="s1">&#39;$f$/8&#39;</span><span class="p">,</span>
<span class="linenos">312</span>                                        <span class="mf">9.5</span><span class="p">:</span> <span class="s1">&#39;$f$/9.5&#39;</span><span class="p">,</span>
<span class="linenos">313</span>                                        <span class="mf">11.0</span> <span class="p">:</span><span class="s1">&#39;$f$/11&#39;</span><span class="p">,</span>
<span class="linenos">314</span>                                        <span class="mf">13.0</span> <span class="p">:</span><span class="s1">&#39;$f$/13&#39;</span><span class="p">,</span>
<span class="linenos">315</span>                                        <span class="mf">16.0</span> <span class="p">:</span><span class="s1">&#39;$f$/16&#39;</span><span class="p">,</span>
<span class="linenos">316</span>                                        <span class="mf">19.0</span> <span class="p">:</span><span class="s1">&#39;$f$/19&#39;</span><span class="p">,</span>
<span class="linenos">317</span>                                        <span class="mf">22.0</span> <span class="p">:</span><span class="s1">&#39;$f$/22&#39;</span><span class="p">,</span>
<span class="linenos">318</span>                                        <span class="p">},</span>
<span class="linenos">319</span>                   <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual line&#39;</span><span class="p">,</span>
<span class="linenos">320</span>                   <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Aperture&#39;</span><span class="p">,</span>
<span class="linenos">321</span>                   <span class="p">}</span>
<span class="linenos">322</span><span class="n">block_params_camera</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_3&#39;</span><span class="p">,</span>
<span class="linenos">323</span>                       <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">324</span>                       <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">325</span>                       <span class="s1">&#39;f_params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">camera_params_1</span><span class="p">,</span> <span class="n">camera_params_2</span><span class="p">,</span> <span class="n">camera_params_3</span><span class="p">,</span>
<span class="linenos">326</span>                                    <span class="n">camera_params_4</span><span class="p">],</span>
<span class="linenos">327</span>                       <span class="s1">&#39;mirror_x&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">328</span>                       <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]],</span>
<span class="linenos">329</span>                       <span class="p">}</span>
<span class="linenos">330</span>
<span class="linenos">331</span>
<span class="linenos">332</span><span class="k">def</span> <span class="nf">old_EV</span><span class="p">(</span><span class="n">EV</span><span class="p">):</span>  <span class="c1"># C2(EV100) in wiki</span>
<span class="linenos">333</span>    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">EV</span> <span class="o">+</span> <span class="mf">13.654</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.3322</span>
<span class="linenos">334</span>
<span class="linenos">335</span><span class="n">EV_para</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;EV&#39;</span><span class="p">,</span>
<span class="linenos">336</span>           <span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="linenos">337</span>           <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">19.0</span><span class="p">,</span>
<span class="linenos">338</span>           <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">old_EV</span><span class="p">(</span><span class="n">u</span><span class="p">),</span>
<span class="linenos">339</span>           <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;EV$_</span><span class="si">{100}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="linenos">340</span>           <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos">341</span>           <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="linenos">342</span>           <span class="s1">&#39;align_func&#39;</span><span class="p">:</span> <span class="n">old_EV</span><span class="p">,</span>
<span class="linenos">343</span>           <span class="s1">&#39;title_x_shift&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">344</span>           <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span>
<span class="linenos">345</span>           <span class="p">}</span>
<span class="linenos">346</span><span class="n">EV_block</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_8&#39;</span><span class="p">,</span>
<span class="linenos">347</span>            <span class="s1">&#39;f_params&#39;</span><span class="p">:</span> <span class="n">EV_para</span><span class="p">,</span>
<span class="linenos">348</span>            <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos">349</span>            <span class="p">}</span>
<span class="linenos">350</span><span class="c1"># maximum focal length</span>
<span class="linenos">351</span><span class="n">FL_t_para</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="linenos">352</span>           <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">10000.0</span><span class="p">,</span>
<span class="linenos">353</span>           <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">((</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">30</span><span class="p">,</span>
<span class="linenos">354</span>           <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<span class="linenos">355</span>           <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">356</span>           <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">357</span>           <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;t (s)&#39;</span><span class="p">,</span>
<span class="linenos">358</span>           <span class="s1">&#39;text_format&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;1/</span><span class="si">%3.0f</span><span class="s2"> s&quot;</span><span class="p">,</span>
<span class="linenos">359</span>           <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="s1">&#39;shutter&#39;</span><span class="p">,</span>
<span class="linenos">360</span>           <span class="p">}</span>
<span class="linenos">361</span><span class="n">FL_factor_params_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">4.0</span><span class="p">,</span>
<span class="linenos">362</span>                      <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span>
<span class="linenos">363</span>                      <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">factor</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span><span class="n">factor</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span>
<span class="linenos">364</span>                      <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Sensor, IS&#39;</span><span class="p">,</span>
<span class="linenos">365</span>                      <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual point&#39;</span><span class="p">,</span>
<span class="linenos">366</span>                      <span class="s1">&#39;manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">):</span> <span class="s1">&#39;DSLR&#39;</span><span class="p">,</span>
<span class="linenos">367</span>                                           <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="p">):</span> <span class="s1">&#39;35mm&#39;</span><span class="p">,</span>
<span class="linenos">368</span>                                           <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">):</span> <span class="s1">&#39;DSLR IS&#39;</span><span class="p">,</span>
<span class="linenos">369</span>                                           <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="p">):</span> <span class="s1">&#39;35mm IS&#39;</span><span class="p">,</span>
<span class="linenos">370</span>                      <span class="p">},</span>
<span class="linenos">371</span>                      <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos">372</span>                      <span class="s1">&#39;text_size_manual&#39;</span><span class="p">:</span> <span class="n">text</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">footnotesize</span><span class="p">,</span>  <span class="c1"># pyx directive</span>
<span class="linenos">373</span>                      <span class="p">}</span>
<span class="linenos">374</span><span class="n">FL_fl_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;u_min&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
<span class="linenos">375</span>                <span class="s1">&#39;u_max&#39;</span><span class="p">:</span> <span class="mf">1000.0</span><span class="p">,</span>
<span class="linenos">376</span>                <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">FL</span><span class="p">:</span><span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span><span class="n">FL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>
<span class="linenos">377</span>                <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Max focal length&#39;</span><span class="p">,</span>
<span class="linenos">378</span>                <span class="s1">&#39;tick_levels&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos">379</span>                <span class="s1">&#39;tick_text_levels&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">380</span>                <span class="s1">&#39;tick_side&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
<span class="linenos">381</span>                <span class="s1">&#39;scale_type&#39;</span><span class="p">:</span> <span class="s1">&#39;manual line&#39;</span><span class="p">,</span>
<span class="linenos">382</span>                <span class="s1">&#39;manual_axis_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mf">20.0</span><span class="p">:</span> <span class="s1">&#39;20mm&#39;</span><span class="p">,</span>
<span class="linenos">383</span>                                     <span class="mf">35.0</span><span class="p">:</span> <span class="s1">&#39;35mm&#39;</span><span class="p">,</span>
<span class="linenos">384</span>                                     <span class="mf">50.0</span><span class="p">:</span> <span class="s1">&#39;50mm&#39;</span><span class="p">,</span>
<span class="linenos">385</span>                                     <span class="mf">80.0</span><span class="p">:</span> <span class="s1">&#39;80mm&#39;</span><span class="p">,</span>
<span class="linenos">386</span>                                     <span class="mf">100.0</span><span class="p">:</span> <span class="s1">&#39;100mm&#39;</span><span class="p">,</span>
<span class="linenos">387</span>                                     <span class="mf">150.0</span><span class="p">:</span> <span class="s1">&#39;150mm&#39;</span><span class="p">,</span>
<span class="linenos">388</span>                                     <span class="mf">200.0</span><span class="p">:</span> <span class="s1">&#39;200mm&#39;</span><span class="p">,</span>
<span class="linenos">389</span>                                     <span class="mf">300.0</span><span class="p">:</span> <span class="s1">&#39;300mm&#39;</span><span class="p">,</span>
<span class="linenos">390</span>                                     <span class="mf">400.0</span><span class="p">:</span> <span class="s1">&#39;400mm&#39;</span><span class="p">,</span>
<span class="linenos">391</span>                                     <span class="mf">500.0</span><span class="p">:</span> <span class="s1">&#39;500mm&#39;</span><span class="p">,</span>
<span class="linenos">392</span>                                     <span class="mf">1000.0</span><span class="p">:</span> <span class="s1">&#39;1000mm&#39;</span><span class="p">}</span>
<span class="linenos">393</span>                <span class="p">}</span>
<span class="linenos">394</span>
<span class="linenos">395</span><span class="n">FL_block_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;block_type&#39;</span><span class="p">:</span> <span class="s1">&#39;type_1&#39;</span><span class="p">,</span>
<span class="linenos">396</span>                   <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">12.0</span><span class="p">,</span>
<span class="linenos">397</span>                   <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
<span class="linenos">398</span>                   <span class="s1">&#39;f1_params&#39;</span><span class="p">:</span> <span class="n">FL_t_para</span><span class="p">,</span>
<span class="linenos">399</span>                   <span class="s1">&#39;f2_params&#39;</span><span class="p">:</span> <span class="n">FL_factor_params_2</span><span class="p">,</span>
<span class="linenos">400</span>                   <span class="s1">&#39;f3_params&#39;</span><span class="p">:</span> <span class="n">FL_fl_params</span><span class="p">,</span>
<span class="linenos">401</span>                   <span class="s1">&#39;mirror_x&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="linenos">402</span>                   <span class="s1">&#39;proportion&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="linenos">403</span>                   <span class="s1">&#39;isopleth_values&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">),</span> <span class="s1">&#39;x&#39;</span><span class="p">]],</span>
<span class="linenos">404</span>                   <span class="p">}</span>
<span class="linenos">405</span>
<span class="linenos">406</span><span class="n">main_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ex_photo_exposure.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;ex_photo_exposure.eps&#39;</span><span class="p">],</span>
<span class="linenos">407</span>               <span class="s1">&#39;paper_height&#39;</span><span class="p">:</span> <span class="mf">35.0</span><span class="p">,</span>
<span class="linenos">408</span>               <span class="s1">&#39;paper_width&#39;</span><span class="p">:</span> <span class="mf">35.0</span><span class="p">,</span>
<span class="linenos">409</span>               <span class="s1">&#39;block_params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">block_params</span><span class="p">,</span> <span class="n">block_params_weather</span><span class="p">,</span> <span class="n">block_params_scene</span><span class="p">,</span>
<span class="linenos">410</span>                                <span class="n">block_params_camera</span><span class="p">,</span> <span class="n">EV_block</span><span class="p">,</span> <span class="n">FL_block_params</span><span class="p">],</span>
<span class="linenos">411</span>               <span class="s1">&#39;transformations&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;scale paper&#39;</span><span class="p">,)],</span>
<span class="linenos">412</span>               <span class="s1">&#39;title_x&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
<span class="linenos">413</span>               <span class="s1">&#39;title_y&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
<span class="linenos">414</span>               <span class="s1">&#39;title_box_width&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="linenos">415</span>               <span class="s1">&#39;title_str&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\LARGE Photography exposure (Setala 1940) \par \copyright Leif Roschier  2009 &#39;</span>
<span class="linenos">416</span>              <span class="p">}</span>
<span class="linenos">417</span><span class="n">Nomographer</span><span class="p">(</span><span class="n">main_params</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2021, Daniel Boulet, Ron Doerfler, Joe Marasco, Leif Roschier.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>